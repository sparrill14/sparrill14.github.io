"use strict";(self.webpackChunktreads=self.webpackChunktreads||[]).push([[792],{581:(t,i,e)=>{e.p;e(836);var s=e(180),o=function(){function t(t,i,e,s){this.xLeft=t,this.yTop=i,this.width=e,this.height=s,this.yBottom=this.yTop+this.height,this.xRight=this.xLeft+this.width}return t.prototype.draw=function(t){t.beginPath(),t.rect(this.xLeft,this.yTop,this.width,this.height),t.fillStyle="black",t.fill()},t}();const n=e.p+"b522d2830ca0e8728583.mp3";var a,h=(a=function(t,i){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])},a(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}),r=function(){function t(t,i,e,s,o,a,h,r){this.xPos=t,this.yPos=i,this.theta=e,this.speed=s,this.xVelocity=Math.cos(this.theta)*this.speed,this.yVelocity=Math.sin(this.theta)*this.speed,this.bounces=0,this.maxBounces=o,this.canvasWidth=a,this.canvasHeight=h,this.isDestroyed=r,this.tankDestroyAudio=new Audio(n)}return t.prototype.updatePosition=function(t){var i=this;this.xPos+=this.xVelocity,this.yPos+=this.yVelocity,(this.xPos<=0||this.xPos>this.canvasWidth)&&(this.xVelocity=-this.xVelocity,this.bounces++),(this.yPos<=0||this.yPos>this.canvasHeight)&&(this.yVelocity=-this.yVelocity,this.bounces++),t.obstacles.forEach((function(t){if(i.xPos>t.xLeft&&i.xPos<t.xRight&&i.yPos>t.yTop&&i.yPos<t.yBottom){i.bounces++;var e=Math.abs(i.xPos-t.xLeft),s=Math.abs(i.xPos-t.xRight),o=Math.abs(i.yPos-t.yTop),n=Math.abs(i.yPos-t.yBottom),a=Math.min(e,s,o,n);a===o?(i.yPos=t.yTop-1,i.yVelocity=-i.yVelocity):a===n?(i.yPos=t.yBottom+1,i.yVelocity=-i.yVelocity):a===e?(i.xPos=t.xLeft-1,i.xVelocity=-i.xVelocity):a===s&&(i.xPos=t.xRight+1,i.xVelocity=-i.xVelocity)}})),this.bounces>this.maxBounces&&(this.isDestroyed=!0)},t.prototype.checkEnemyHit=function(t){var i=this;t.forEach((function(t){t.isDestroyed||i.xPos>t.xLeft&&i.xPos<t.xRight&&i.yPos>t.yTop&&i.yPos<t.yBottom&&(i.isDestroyed=!0,t.isDestroyed=!0,i.tankDestroyAudio.play(),console.log("Enemy hit!!!"))}))},t.prototype.checkPlayerHit=function(t){t.isDestroyed||this.xPos>t.xLeft&&this.xPos<t.xRight&&this.yPos>t.yTop&&this.yPos<t.yBottom&&(t.isDestroyed=!0,this.isDestroyed=!0,console.log("Player Hit!!!"))},t.prototype.draw=function(t){t.beginPath(),t.arc(this.xPos,this.yPos,3,0,2*Math.PI),t.fillStyle="white",t.fill(),t.lineWidth=2,t.strokeStyle="black",t.stroke(),t.closePath()},t.prototype.reload=function(t,i,e,s,o,n){this.xPos=t,this.yPos=i,this.theta=e,this.isDestroyed=s,this.xVelocity=Math.cos(this.theta)*this.speed,this.yVelocity=Math.sin(this.theta)*this.speed,this.canvasWidth=o,this.canvasHeight=n,this.bounces=0},t.prototype.willHitPlayerTank=function(t,i){for(var e=this.xPos,s=this.yPos,o=this.xVelocity,n=this.yVelocity,a=0;a<=this.maxBounces;)if(s+=n,((e+=o)<=0||e>this.canvasWidth)&&(o=-o,a++),(s<=0||s>this.canvasHeight)&&(n=-n,a++),t.obstacles.forEach((function(t){e>t.xLeft&&e<t.xRight&&s>t.yTop&&s<t.yBottom&&(a++,o=-o,n=-n)})),e>i.xLeft&&e<i.xRight&&s>i.yTop&&s<i.yBottom)return!0;return!1},t}(),c=function(t){function i(i,e,s,o,n,a){return t.call(this,i,e,s,4,1,o,n,a)||this}return h(i,t),i}(r),l=function(t){function i(i,e,s,o,n,a){return t.call(this,i,e,s,5,0,o,n,a)||this}return h(i,t),i}(r),d=function(t){function i(i,e,s,o,n,a){return t.call(this,i,e,s,7,2,o,n,a)||this}return h(i,t),i}(r),v=function(){var t=function(i,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])},t(i,e)};return function(i,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),u=function(){function t(t,i,e,s){this.reticuleWidth=5,this.color=i,this.dashPattern=t,this.renderReticule=e,this.tankSize=s}return t.prototype.draw=function(t,i,e,s,o){this.renderReticule&&(t.strokeStyle=this.color,t.setLineDash(this.dashPattern),t.beginPath(),t.moveTo(i+this.tankSize/2,e+this.tankSize/2),t.lineTo(s,o),t.lineWidth=this.reticuleWidth,t.stroke())},t}(),y=function(t){function i(){return t.call(this,[0,0],"blue",!1,0)||this}return v(i,t),i}(u),p=(function(t){function i(i){return t.call(this,[5,5],"blue",!0,i)||this}v(i,t)}(u),function(t){function i(i,e){return t.call(this,[4,1],e,!0,i)||this}v(i,t)}(u),function(t){function i(i,e,s){var o=t.call(this,[1,1],e,!0,i)||this;return o.maxReticuleLength=s,o}return v(i,t),i.prototype.draw=function(t,i,e,s,o){var n=s-i,a=o-e,h=Math.sqrt(Math.pow(n,2)+Math.pow(a,2))/this.maxReticuleLength,r=10*h+2,c=10*(1-h)+5;if(this.renderReticule){t.strokeStyle=this.color,t.setLineDash([r,c]),t.beginPath(),t.moveTo(i+this.tankSize/2,e+this.tankSize/2),t.lineTo(s,o),t.lineWidth=this.reticuleWidth,t.stroke(),t.setLineDash([]);var l=10;t.beginPath(),t.moveTo(s-l,o-l),t.lineTo(s+l,o+l),t.stroke(),t.beginPath(),t.moveTo(s-l,o+l),t.lineTo(s+l,o-l),t.stroke()}},i}(u));const f=e.p+"bdf5203edd6a7217bbbb.mp3";var m,g=function(){var t=function(i,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])},t(i,e)};return function(i,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();!function(t){t[t.NORTH=1]="NORTH",t[t.SOUTH=2]="SOUTH",t[t.EAST=3]="EAST",t[t.WEST=4]="WEST",t[t.NORTHEAST=5]="NORTHEAST",t[t.NORTHWEST=6]="NORTHWEST",t[t.SOUTHEAST=7]="SOUTHEAST",t[t.SOUTHWEST=8]="SOUTHWEST",t[t.UNKNOWN=9]="UNKNOWN"}(m||(m={}));var P=function(){function t(t,i,e,s,o,n,a,h,r){this.gunBarrellWidth=7,this.isDestroyed=!1,this.twoPi=2*Math.PI,this.lastDirectionMoved=m.UNKNOWN,this.wasLastMoveBlocked=!1,this.consecutiveDirectionMoves=0,this.keyStates={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1,w:!1,a:!1,s:!1,d:!1,W:!1,A:!1,S:!1,D:!1},this.ammunition=[],this.reticule=i,this.xPos=e,this.yPos=s,this.xLeft=e,this.xRight=e+n,this.yTop=s,this.yBottom=s+n,this.speed=o,this.size=n,this.color=a,this.canvasWidth=t.width,this.canvasHeight=t.height,this.obstacleCanvas=h,this.tankMidpoint=this.size/2,this.ammunition=r,this.maxAmmunition=r.length,this.aimAngle=90;var c=t.getBoundingClientRect();this.xOffset=c.left,this.yOffset=c.top,this.aimXPos=t.width/2,this.aimYPos=t.height/2}return t.prototype.draw=function(t){if(!this.isDestroyed){t.fillStyle=this.color,t.fillRect(this.xPos,this.yPos,this.size,this.size),t.setLineDash([]),t.lineJoin="bevel",t.strokeStyle="black",t.lineWidth=2,t.strokeRect(this.xPos,this.yPos,this.size,this.size),t.beginPath(),t.arc(this.xPos+this.tankMidpoint,this.yPos+this.tankMidpoint,this.size/3,0,this.twoPi),t.stroke();var i=this.xPos+this.tankMidpoint+Math.cos(this.aimAngle)*this.size,e=this.yPos+this.tankMidpoint+Math.sin(this.aimAngle)*this.size;t.beginPath(),t.moveTo(this.xPos+this.tankMidpoint,this.yPos+this.tankMidpoint),t.lineTo(i,e),t.lineWidth=this.gunBarrellWidth,t.stroke()}},t.prototype.updatePosition=function(t){this.up()&&this.right()?this.moveNorthEast():this.up()&&this.left()?this.moveNorthWest():this.down()&&this.right()?this.moveSouthEast():this.down()&&this.left()?this.moveSouthWest():this.up()?this.moveNorth():this.down()?this.moveSouth():this.left()?this.moveWest():this.right()&&this.moveEast(),this.xLeft=this.xPos,this.xRight=this.xPos+this.size,this.yTop=this.yPos,this.yBottom=this.yPos+this.size},t.prototype.aim=function(t,i,e){if(!this.isDestroyed){var s,o;o=t-this.xPos-this.tankMidpoint,s=i-this.yPos-this.tankMidpoint;var n=Math.atan2(s,o);n<0&&(n+=2*Math.PI),this.aimAngle=n}},t.prototype.shoot=function(t){},t.prototype.moveInLastDirectionMoved=function(){this.moveInCardinalDirection(this.lastDirectionMoved)},t.prototype.getRandomDirection=function(){var t=Object.keys(m).map((function(t){return Number.parseInt(t)})).filter((function(t){return!Number.isNaN(t)}));return t[Math.floor(Math.random()*t.length)]},t.prototype.moveInCardinalDirection=function(t){switch(t){case m.NORTH:this.moveNorth();break;case m.SOUTH:this.moveSouth();break;case m.EAST:this.moveEast();break;case m.WEST:this.moveWest();break;case m.NORTHEAST:this.moveNorthEast();break;case m.NORTHWEST:this.moveNorthWest();break;case m.SOUTHEAST:this.moveSouthEast();break;case m.SOUTHWEST:this.moveSouthWest();break;default:var i=Object.values(m).filter((function(t){return"number"==typeof t})),e=Math.floor(Math.random()*i.length);this.moveInCardinalDirection(i[e])}},t.prototype.moveNorth=function(){this.lastDirectionMoved==m.NORTH?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.NORTH;for(var t=!1,i=0;i<this.obstacleCanvas.obstacles.length;i++){var e=this.obstacleCanvas.obstacles[i];if(this.yPos-this.speed<e.yTop+e.height&&this.yPos>e.yTop&&e.xLeft<this.xPos+this.size&&this.xPos<e.xRight){this.yPos=e.yBottom,t=!0;break}}t?this.wasLastMoveBlocked=!0:this.yPos=Math.max(this.yPos-this.speed,0)},t.prototype.moveSouth=function(){this.lastDirectionMoved==m.SOUTH?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.SOUTH;for(var t=!1,i=0;i<this.obstacleCanvas.obstacles.length;i++){var e=this.obstacleCanvas.obstacles[i];if(this.yPos+this.speed+this.size>e.yTop&&this.yPos<e.yTop+e.height&&e.xLeft<this.xPos+this.size&&this.xPos<e.xRight){this.yPos=e.yTop-this.size,t=!0;break}}t?this.wasLastMoveBlocked=!0:this.yPos=Math.min(this.yPos+this.speed,this.canvasHeight-this.size)},t.prototype.moveWest=function(){this.lastDirectionMoved==m.WEST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.WEST;for(var t=!1,i=0;i<this.obstacleCanvas.obstacles.length;i++){var e=this.obstacleCanvas.obstacles[i];if(this.xPos-this.speed<e.xRight&&this.xPos>e.xLeft&&e.yTop<this.yPos+this.size&&this.yPos<e.yBottom){this.xPos=e.xRight,t=!0;break}}t?this.wasLastMoveBlocked=!0:this.xPos=Math.max(this.xPos-this.speed,0)},t.prototype.moveEast=function(){this.lastDirectionMoved==m.EAST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.EAST;for(var t=!1,i=0;i<this.obstacleCanvas.obstacles.length;i++){var e=this.obstacleCanvas.obstacles[i];if(this.xPos+this.speed+this.size>e.xLeft&&this.xPos<e.xLeft+e.width&&e.yTop<this.yPos+this.size&&this.yPos<e.yBottom){this.xPos=e.xLeft-this.size,t=!0;break}}t?this.wasLastMoveBlocked=!0:this.xPos=Math.min(this.xPos+this.speed,this.canvasWidth-this.size)},t.prototype.moveNorthEast=function(){this.lastDirectionMoved==m.NORTHEAST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.NORTHEAST;for(var t=!1,i=!1,e=0;e<this.obstacleCanvas.obstacles.length;e++){var s=this.obstacleCanvas.obstacles[e];!t&&this.yPos-this.speed<s.yTop+s.height&&this.yPos>s.yTop&&s.xLeft<this.xPos+this.size&&this.xPos<s.xRight&&(this.yPos=s.yBottom,t=!0),!i&&this.xPos+this.speed+this.size>s.xLeft&&this.xPos<s.xLeft+s.width&&s.yTop<this.yPos+this.size&&this.yPos<s.yBottom&&(this.xPos=s.xLeft-this.size,i=!0)}t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPos=Math.max(this.yPos-this.speed,0)),i||(this.xPos=Math.min(this.xPos+this.speed,this.canvasWidth-this.size))},t.prototype.moveNorthWest=function(){this.lastDirectionMoved==m.NORTHWEST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.NORTHWEST;for(var t=!1,i=!1,e=0;e<this.obstacleCanvas.obstacles.length;e++){var s=this.obstacleCanvas.obstacles[e];!t&&this.yPos-this.speed<s.yTop+s.height&&this.yPos>s.yTop&&s.xLeft<this.xPos+this.size&&this.xPos<s.xRight&&(this.yPos=s.yBottom,t=!0),!i&&this.xPos-this.speed<s.xRight&&this.xPos>s.xLeft&&s.yTop<this.yPos+this.size&&this.yPos<s.yBottom&&(this.xPos=s.xRight,i=!0)}t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPos=Math.max(this.yPos-this.speed,0)),i||(this.xPos=Math.max(this.xPos-this.speed,0))},t.prototype.moveSouthEast=function(){this.lastDirectionMoved==m.SOUTHEAST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.SOUTHEAST;for(var t=!1,i=!1,e=0;e<this.obstacleCanvas.obstacles.length;e++){var s=this.obstacleCanvas.obstacles[e];!t&&this.yPos+this.speed+this.size>s.yTop&&this.yPos<s.yTop+s.height&&s.xLeft<this.xPos+this.size&&this.xPos<s.xRight&&(this.yPos=s.yTop-this.size,t=!0),!i&&this.xPos+this.speed+this.size>s.xLeft&&this.xPos<s.xLeft+s.width&&s.yTop<this.yPos+this.size&&this.yPos<s.yBottom&&(this.xPos=s.xLeft-this.size,i=!0)}t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPos=Math.min(this.yPos+this.speed,this.canvasHeight-this.size)),i||(this.xPos=Math.min(this.xPos+this.speed,this.canvasWidth-this.size))},t.prototype.moveSouthWest=function(){this.lastDirectionMoved==m.SOUTHWEST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=m.SOUTHWEST;for(var t=!1,i=!1,e=0;e<this.obstacleCanvas.obstacles.length;e++){var s=this.obstacleCanvas.obstacles[e];!t&&this.yPos+this.speed+this.size>s.yTop&&this.yPos<s.yTop+s.height&&s.xLeft<this.xPos+this.size&&this.xPos<s.xRight&&(this.yPos=s.yTop-this.size,t=!0),!i&&this.xPos-this.speed<s.xRight&&this.xPos>s.xLeft&&s.yTop<this.yPos+this.size&&this.yPos<s.yBottom&&(this.xPos=s.xRight,i=!0)}t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPos=Math.min(this.yPos+this.speed,this.canvasHeight-this.size)),i||(this.xPos=Math.max(this.xPos-this.speed,0))},t.prototype.up=function(){return this.keyStates.ArrowUp||this.keyStates.w||this.keyStates.W},t.prototype.down=function(){return this.keyStates.ArrowDown||this.keyStates.s||this.keyStates.S},t.prototype.left=function(){return this.keyStates.ArrowLeft||this.keyStates.a||this.keyStates.A},t.prototype.right=function(){return this.keyStates.ArrowRight||this.keyStates.d||this.keyStates.D},t}(),x=function(t){function i(i,e,s,o,n,a,h,r,l){var d=t.call(this,i,e,s,o,n,a,h,r,l)||this;return d.tankFireAudio=new Audio(f),document.addEventListener("keydown",(function(t){d.keyStates.hasOwnProperty(t.key)&&(d.keyStates[t.key]=!0)})),document.addEventListener("keyup",(function(t){d.keyStates.hasOwnProperty(t.key)&&(d.keyStates[t.key]=!1)})),i.addEventListener("mousemove",(function(t){d.aimXPos=t.clientX-d.xOffset,d.aimYPos=t.clientY-d.yOffset})),i.addEventListener("click",(function(t){if(!d.isDestroyed){var e=d.ammunition.findIndex((function(t){return t.isDestroyed}));-1!==e&&(d.tankFireAudio.play(),d.ammunition[e]=new c(d.xPos+d.size/2,d.yPos+d.size/2,d.aimAngle,i.width,i.height,!1))}})),d}return g(i,t),i.prototype.aim=function(t,i,e){if(!this.isDestroyed){var s,o;o=t-this.xPos-this.tankMidpoint,s=i-this.yPos-this.tankMidpoint;var n=Math.atan2(s,o);n<0&&(n+=2*Math.PI),this.aimAngle=n}},i.prototype.shoot=function(t){},i}(P),w=function(t){function i(i,e,s,o,n,a,h,r,c){return t.call(this,i,e,s,o,n,a,h,r,c)||this}return g(i,t),i}(P),b=function(t){function i(i,e,s,o){var n=this,a=[new l(0,0,0,0,0,!0)];return n=t.call(this,i,new y,e,s,0,30,"#5784ba",o,a)||this,setInterval((function(){if(!n.isDestroyed){var t=n.ammunition.findIndex((function(t){return t.isDestroyed}));-1!==t&&(n.ammunition[t]=new l(n.xPos+n.size/2,n.yPos+n.size/2,n.aimAngle,n.canvasWidth,n.canvasHeight,!1))}}),5e3),n}return g(i,t),i.prototype.updatePosition=function(t){},i.prototype.shoot=function(t){},i.prototype.aim=function(t,i,e){if(!this.isDestroyed){var s,o;o=e.xPos+e.size/2-this.xPos-this.tankMidpoint,s=e.yPos+e.size/2-this.yPos-this.tankMidpoint;var n=Math.atan2(s,o);n<0&&(n+=2*Math.PI),this.aimAngle=n}},i}(w),T=function(t){function i(i,e,s,o,n){var a=this;return(a=t.call(this,i,new y,e,s,0,30,"#ebe1b9",o,n)||this).aimAngleChangeAmount=0,a}return g(i,t),i.prototype.getAngleChangeAmount=function(){return Math.floor(721*Math.random())+-360},i.prototype.updatePosition=function(t){},i.prototype.shoot=function(t){var i=this.ammunition.findIndex((function(t){return t.isDestroyed}));-1!==i&&(this.ammunition[i].reload(this.xPos+this.size/2,this.yPos+this.size/2,this.aimAngle,!0,this.canvasWidth,this.canvasHeight),this.ammunition[i].willHitPlayerTank(this.obstacleCanvas,t)&&(this.ammunition[i].isDestroyed=!1))},i.prototype.aim=function(t,i,e){this.isDestroyed||(this.aimAngleChangeAmount>0?(this.aimAngle+=.01,this.aimAngleChangeAmount-=1):this.aimAngleChangeAmount<0?(this.aimAngle-=.01,this.aimAngleChangeAmount+=1):this.aimAngleChangeAmount=this.getAngleChangeAmount())},i}(w),k=function(t){function i(i,e,s,o,n,a){var h=this;return(h=t.call(this,i,new y,e,s,1.2,30,"#fd8a8a",o,n)||this).aimAngleChangeAmount=0,h.aggressionFactor=15,h.path=[],h.pathRecaculationInterval=60,h.drawNavigationGrid=!1,h.navigationGrid=a,h.currentNode=h.navigationGrid.getNodeFromTank(h),h}return g(i,t),i.prototype.draw=function(i){var e,s=this;if(this.drawNavigationGrid){i.lineWidth=1;for(var o=0;o<=this.navigationGrid.gridYLength;o++)i.fillStyle="blue",i.beginPath(),i.moveTo(0,o*this.navigationGrid.gridCellWidth),i.lineTo(this.navigationGrid.gridXLength*this.navigationGrid.gridCellWidth,o*this.navigationGrid.gridCellWidth),i.stroke();for(var n=0;n<=this.navigationGrid.gridXLength;n++)i.fillStyle="blue",i.beginPath(),i.moveTo(n*this.navigationGrid.gridCellWidth,0),i.lineTo(n*this.navigationGrid.gridCellWidth,this.navigationGrid.gridXLength*this.navigationGrid.gridCellWidth),i.stroke();i.fillStyle=this.color,null===(e=this.path)||void 0===e||e.forEach((function(t,e,o){i.beginPath(),i.arc(t.x*s.navigationGrid.gridCellWidth+s.navigationGrid.gridCellWidth/2,t.y*s.navigationGrid.gridCellWidth+s.navigationGrid.gridCellWidth/2,5,0,2*Math.PI),i.fill()}))}t.prototype.draw.call(this,i)},i.prototype.updatePosition=function(t){if(this.pathRecaculationInterval-=1,null==this.path||0==this.path.length||0==this.pathRecaculationInterval){this.navigationGrid.reset();var i=this.navigationGrid.getNodeFromTank(this),e=this.navigationGrid.getNodeFromTank(t),s=this.navigationGrid.getNodeInRadiusOfTarget(e,this.aggressionFactor);this.path=this.navigationGrid.aStar(i,s),this.pathRecaculationInterval=60,null==this.path&&console.log("Path is null")}else{this.currentNode=this.navigationGrid.getNodeFromTank(this);var o=this.path[0].x-this.currentNode.x,n=this.path[0].y-this.currentNode.y;if(this.wasLastMoveBlocked&&this.consecutiveDirectionMoves>2){var a=this.getRandomDirection();this.moveInCardinalDirection(a),this.consecutiveDirectionMoves=0;var h=Math.random();1===o&&0===n?h<.5?this.moveSouthEast():this.moveNorthEast():-1===o&&0===n?h<.5?this.moveNorthWest():this.moveSouthWest():0===o&&1===n?h<.5?this.moveSouthEast():this.moveSouthWest():0===o&&-1===n?h<.5?this.moveNorthWest():this.moveNorthEast():1===o&&1===n?h<.5?this.moveSouth():this.moveEast():1===o&&-1===n?h<.5?this.moveNorth():this.moveEast():-1===o&&1===n?h<.5?this.moveSouth():this.moveWest():-1===o&&-1===n&&(h<.5?this.moveNorth():this.moveWest())}else 1===o&&0===n?this.moveEast():-1===o&&0===n?this.moveWest():0===o&&1===n?this.moveSouth():0===o&&-1===n?this.moveNorth():1===o&&1===n?this.moveSouthEast():1===o&&-1===n?this.moveNorthEast():-1===o&&1===n?this.moveSouthWest():-1===o&&-1===n&&this.moveNorthWest();this.path[0].x==this.currentNode.x&&this.path[0].y==this.currentNode.y&&this.path.splice(0,1)}this.xLeft=this.xPos,this.xRight=this.xPos+this.size,this.yTop=this.yPos,this.yBottom=this.yPos+this.size},i.prototype.shoot=function(t){var i=this.ammunition.findIndex((function(t){return t.isDestroyed}));-1!==i&&(this.ammunition[i].reload(this.xPos+this.size/2,this.yPos+this.size/2,this.aimAngle,!0,this.canvasWidth,this.canvasHeight),this.ammunition[i].willHitPlayerTank(this.obstacleCanvas,t)&&(this.ammunition[i].isDestroyed=!1))},i.prototype.aim=function(t,i,e){if(!this.isDestroyed){var s,o;o=e.xPos+e.size/2-this.xPos-this.tankMidpoint,s=e.yPos+e.size/2-this.yPos-this.tankMidpoint;var n=Math.atan2(s,o);n<0&&(n+=2*Math.PI),this.aimAngle=n}},i}(w),M=function(t){function i(i,e,s,o){var n="#6384a1",a=[new c(0,0,0,0,0,!0),new c(0,0,0,0,0,!0),new c(0,0,0,0,0,!0),new c(0,0,0,0,0,!0),new c(0,0,0,0,0,!0)];return t.call(this,i,new p(30,n,i.width),e,s,2,30,n,o,a)||this}return g(i,t),i}(x),C=function(){function t(t,i,e,s){var o=this;this.obstacles=[],this.width=i,this.height=e,this.obstacles=s,window.addEventListener("resize",this.resizeCanvas.bind(this)),this.obstacleCanvas=document.querySelector(t),this.obstacleCanvas.width=i,this.obstacleCanvas.height=e,s.forEach((function(t){t.draw(o.obstacleCanvas.getContext("2d"))}))}return t.prototype.clearObstacles=function(){var t=this.obstacleCanvas.getContext("2d");t&&t.clearRect(0,0,this.obstacleCanvas.width,this.obstacleCanvas.height),this.obstacles=[]},t.prototype.resizeCanvas=function(){},t}(),S=function(){function t(t){this.canvas=t,this.playerWin=!1,this.enemyWin=!1;var i=this.canvas.getContext("2d");if(!i)throw new Error("2d context not supported or canvas element not found.");this.context=i}return t.prototype.initializeCanvas=function(t,i){this.canvas.width=t,this.canvas.height=i},t.prototype.renderLevelOverScreen=function(){if(!this.context)throw new Error("2d context not supported or canvas element not found.");var t=this.playerWin?"Win":this.enemyWin?"Lose":"";if(""!==t){this.context.font="".concat(100,"px Arial"),this.context.lineWidth=5,this.context.strokeStyle=this.playerWin?"green":"red",this.context.fillStyle=this.playerWin?"green":"red";var i=this.context.measureText(t).width,e=(this.canvas.width-i)/2,s=this.canvas.height/2+50;this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.strokeText(t,e,s),this.context.fillText(t,e,s)}},t.prototype.render=function(t,i,e){var s=this;if(!this.context)throw new Error("2d context not supported or canvas element not found.");this.context.clearRect(0,0,this.canvas.width,this.canvas.height),i.isDestroyed?this.enemyWin=!0:e.every((function(t){return t.isDestroyed}))?this.playerWin=!0:(i.updatePosition(i),i.aim(i.aimXPos,i.aimYPos,i),e.forEach((function(t){t.updatePosition(i),t.aim(t.aimXPos,t.aimYPos,i),t.shoot(i)})),e.forEach((function(t){t.draw(s.context),t.reticule.draw(s.context,t.xPos,t.yPos,t.aimXPos,t.aimYPos),t.ammunition.forEach((function(e){e.isDestroyed||(e.updatePosition(t.obstacleCanvas),e.checkPlayerHit(i),e.draw(s.context))}))})),i.draw(this.context),i.reticule.draw(this.context,i.xPos,i.yPos,i.aimXPos,i.aimYPos),i.ammunition.forEach((function(t){t.isDestroyed||(t.updatePosition(i.obstacleCanvas),t.checkEnemyHit(e),t.draw(s.context))})))},t}(),L=function(){function t(t,i,e,s){this.enemyTanks=[],this.width=i,this.height=e,this.obstacleCanvas=s,this.animationFrameID=null,this.gameRenderer=new S(document.querySelector(t)),this.gameRenderer.initializeCanvas(this.width,this.height),this.lastRenderTime=0,window.addEventListener("resize",this.resizeCanvas.bind(this)),this.playerTank=new M(this.gameRenderer.canvas,200,250,s)}return t.prototype.start=function(){this.animationFrameID||(this.animationFrameID=requestAnimationFrame(this.gameLoop.bind(this)))},t.prototype.stop=function(){this.animationFrameID&&(cancelAnimationFrame(this.animationFrameID),this.animationFrameID=null)},t.prototype.resizeCanvas=function(){},t.prototype.gameLoop=function(t){var i=t-this.lastRenderTime;this.gameRenderer.render(i,this.playerTank,this.enemyTanks),(this.gameRenderer.enemyWin||this.gameRenderer.playerWin)&&(this.stop(),this.obstacleCanvas.clearObstacles(),this.gameRenderer.renderLevelOverScreen()),this.lastRenderTime=t,this.animationFrameID=requestAnimationFrame(this.gameLoop.bind(this))},t.prototype.addEnemyTank=function(t){this.enemyTanks.push(t)},t.prototype.addPlayerTank=function(t){this.playerTank=t},t}(),W=function(t,i){this.g=0,this.h=0,this.f=0,this.walkable=!0,this.parent=null,this.x=t,this.y=i},D=function(){function t(t,i){this.grid=[],this.gridCellWidth=30,this.path=[],this.gridXLength=Math.floor(t.width/this.gridCellWidth),this.gridYLength=Math.floor(t.height/this.gridCellWidth);for(var e=0;e<this.gridXLength;e++){this.grid[e]=[];for(var s=function(t){o.grid[e][t]=new W(e,t);var s=e*o.gridCellWidth,n=s+o.gridCellWidth,a=t*o.gridCellWidth,h=a+o.gridCellWidth;o.grid[e][t].walkable=!i.obstacles.some((function(t){return n>t.xLeft&&s<t.xRight&&h>t.yTop&&a<t.yBottom}))},o=this,n=0;n<this.gridYLength;n++)s(n)}}return t.prototype.reset=function(){for(var t=0;t<this.gridXLength;t++)for(var i=0;i<this.gridYLength;i++)this.grid[t][i].f=0,this.grid[t][i].g=0,this.grid[t][i].h=0,this.grid[t][i].parent=null},t.prototype.getNodeFromTank=function(t){var i=Math.floor((t.xPos+t.size/2)/this.gridCellWidth),e=Math.floor((t.yPos+t.size/2)/this.gridCellWidth);return i=Math.max(0,Math.min(i,this.gridXLength-1)),e=Math.max(0,Math.min(e,this.gridYLength-1)),this.grid[i][e]},t.prototype.getNodeInRadiusOfTarget=function(t,i){for(var e=i,s=[],o=0;o<this.gridXLength;o++)for(var n=0;n<this.gridYLength;n++){var a=this.grid[o][n],h=Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2));h<=e+1&&h>=e-1&&a.walkable&&s.push(a)}return s[Math.floor(Math.random()*s.length)]},t.prototype.aStar=function(t,i){for(var e=[t],s=new Set;e.length>0;){var o=e.sort((function(t,i){return t.f-i.f}))[0];if(o.x===i.x&&o.y===i.y){for(var n=[];null!==o;)n.unshift(o),o=o.parent;return n}e.splice(e.indexOf(o),1),s.add(o);for(var a=0,h=this.getWalkableNeighbors(o);a<h.length;a++){var r=h[a];if(!s.has(r)){var c=o.g+(r.x-o.x==0||r.y-o.y==0?1:Math.SQRT2);if(e.includes(r)){if(c>=r.g)continue}else e.push(r);r.parent=o,r.g=c,r.h=Math.round(Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2))),r.f=r.g+r.h}}}return null},t.prototype.getWalkableNeighbors=function(t){for(var i=[],e=-1;e<=1;e++)for(var s=-1;s<=1;s++)if(0!==e||0!==s){var o=t.x+e,n=t.y+s;o>=0&&n>=0&&o<this.gridXLength&&n<this.gridYLength&&this.grid[o][n].walkable&&i.push(this.grid[o][n])}return i},t}(),R=function(){var t=function(i,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])},t(i,e)};return function(i,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),E=function(){function t(t){this.canvasWidth=1e3,this.canvasHeight=500,this.obstacleCanvas=t,this.gameCanvas=new L("#game-canvas",this.canvasWidth,this.canvasHeight,t)}return t.prototype.stop=function(){this.gameCanvas.stop()},t.prototype.start=function(){this.gameCanvas.start()},t}(),A=function(t){function i(){var i=this,e=new o(600,100,40,300),s=new C("#obstacle-canvas",1e3,500,[e]);i=t.call(this,s)||this;var n=new b(i.gameCanvas.gameRenderer.canvas,900,240,s);i.gameCanvas.addEnemyTank(n);var a=new M(i.gameCanvas.gameRenderer.canvas,200,250,s);return i.gameCanvas.addPlayerTank(a),i}return R(i,t),i}(E),z=function(t){function i(){var i=this,e=new o(600,150,40,250),s=new C("#obstacle-canvas",1e3,500,[e]);i=t.call(this,s)||this;var n=new b(i.gameCanvas.gameRenderer.canvas,800,100,s),a=new b(i.gameCanvas.gameRenderer.canvas,900,240,s),h=new b(i.gameCanvas.gameRenderer.canvas,800,400,s);i.gameCanvas.addEnemyTank(n),i.gameCanvas.addEnemyTank(a),i.gameCanvas.addEnemyTank(h);var r=new M(i.gameCanvas.gameRenderer.canvas,200,250,s);return i.gameCanvas.addPlayerTank(r),i}return R(i,t),i}(E),O=function(t){function i(){var i=this,e=new o(100,100,200,100),s=new o(700,100,30,100),n=new o(700,350,30,100),a=new C("#obstacle-canvas",1e3,500,[e,s,n]);i=t.call(this,a)||this;var h=[new d(0,0,0,0,0,!0)],r=new T(i.gameCanvas.gameRenderer.canvas,800,300,a,h);i.gameCanvas.addEnemyTank(r);var c=new M(i.gameCanvas.gameRenderer.canvas,200,250,a);return i.gameCanvas.addPlayerTank(c),i}return R(i,t),i}(E),N=function(t){function i(){var i=this,e=new o(250,100,600,40),s=new o(100,350,600,40),n=new C("#obstacle-canvas",1e3,500,[e,s]);i=t.call(this,n)||this;var a=[new l(0,0,0,0,0,!0)],h=new D(i.gameCanvas,i.obstacleCanvas),r=new k(i.gameCanvas.gameRenderer.canvas,900,50,n,a,h);i.gameCanvas.addEnemyTank(r);var c=new M(i.gameCanvas.gameRenderer.canvas,50,450,n);return i.gameCanvas.addPlayerTank(c),i}return R(i,t),i}(E),H=function(t){function i(){var i=this,e=new o(100,100,200,100),s=new o(700,100,30,100),n=new o(700,350,30,100),a=new C("#obstacle-canvas",1e3,500,[e,s,n]);i=t.call(this,a)||this;var h=[new l(0,0,0,0,0,!0)],r=[new d(0,0,0,0,0,!0)],c=new D(i.gameCanvas,i.obstacleCanvas),v=new k(i.gameCanvas.gameRenderer.canvas,800,300,a,h,c),u=new T(i.gameCanvas.gameRenderer.canvas,800,100,a,r),y=new b(i.gameCanvas.gameRenderer.canvas,800,200,a);i.gameCanvas.addEnemyTank(v),i.gameCanvas.addEnemyTank(u),i.gameCanvas.addEnemyTank(y);var p=new M(i.gameCanvas.gameRenderer.canvas,200,250,a);return i.gameCanvas.addPlayerTank(p),i}return R(i,t),i}(E);new(function(){function t(t){this.sliderWidth=Math.min(.8*window.innerWidth,600),this.levels=t,this.activeLevelNumber=1,this.activeLevel=new A,this.createSlider(),this.createJumbotron()}return t.prototype.startActiveLevel=function(){switch(this.activeLevel.stop(),this.activeLevelNumber){case 1:default:this.activeLevel=new A;break;case 2:this.activeLevel=new z;break;case 3:this.activeLevel=new O;break;case 4:this.activeLevel=new N;break;case 5:this.activeLevel=new H}this.activeLevel.start()},t.prototype.createSlider=function(){var t=this,i=10,e=10,o=this.sliderWidth-e-i,n=s.m4Y().domain([1,this.levels]).range([0,o]).clamp(!0),a=s.Ltv("#slider").append("svg").attr("width",this.sliderWidth).attr("height",50).append("g").attr("transform","translate(".concat(e,", 30)"));a.append("g").call(s.l78(n).ticks(this.levels).tickFormat(s.GPZ("1")));var h=a.append("circle").attr("cx",n(this.activeLevelNumber)).attr("cy",-10).attr("r",10).style("fill","red").style("cursor","ew-resize"),r=s.$Er().on("drag",(function(i){var s=i.x-e,o=Math.round(n.invert(s));h.attr("cx",n(o)),t.updateActiveLevel(o)}));h.call(r)},t.prototype.createJumbotron=function(){for(var t=this,i=s.Ltv("#jumbotron"),e=function(e){var s=i.append("div").attr("class","jumbotron-box inactive").on("click",(function(){return t.updateActiveLevel(e)})).append("svg").attr("width","100%").attr("height","100%");s.append("rect").attr("width","100%").attr("height","100%").attr("fill","transparent"),s.append("text").attr("x","50%").attr("y","50%").attr("dominant-baseline","middle").attr("text-anchor","middle").text("Level ".concat(e))},o=1;o<=this.levels;o++)e(o);this.updateActiveLevel(this.activeLevelNumber)},t.prototype.updateActiveLevel=function(t){this.activeLevelNumber=t,s.Ubm(".jumbotron-box").classed("active",(function(i,e){return e+1===t})).classed("inactive",(function(i,e){return e+1!==t})),s.Ltv("circle").attr("cx",s.m4Y().domain([1,this.levels]).range([0,this.sliderWidth-20])(t)),this.startActiveLevel()},t}())(5).startActiveLevel()}},t=>{t.O(0,[96],(()=>{return i=581,t(t.s=i);var i}));t.O()}]);
//# sourceMappingURL=main.e5e616ed4c0c0d0a0b9e.bundle.js.map