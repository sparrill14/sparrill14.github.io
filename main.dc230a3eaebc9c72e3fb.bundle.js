"use strict";(self.webpackChunktreads=self.webpackChunktreads||[]).push([[792],{740:(t,i,s)=>{s(836);var e=s(180);const o="1.5.2",n=s.p+"f16b4ce650f183bff832.mp3",a=s.p+"8c0fb26f73ba98ca3df0.mp3",h=s.p+"0686824ec093b500e317.mp3",r=s.p+"b522d2830ca0e8728583.mp3",d=s.p+"3020ab3b4a3ad7a2f87e.mp3";var l,c;!function(t){t[t.TANK_FIRE=1]="TANK_FIRE",t[t.TANK_DESTROY=2]="TANK_DESTROY",t[t.BOMB_EXPLODE=3]="BOMB_EXPLODE",t[t.BACKGROUND_MUSIC=4]="BACKGROUND_MUSIC",t[t.AMMUNITION_EXPLODE=5]="AMMUNITION_EXPLODE"}(l||(l={}));class m{constructor(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.audioBuffers=new Map,this.backgroundMusicSource=null}loadAllAudio(){const t=[this.loadAudio(l.TANK_FIRE,d),this.loadAudio(l.TANK_DESTROY,r),this.loadAudio(l.BOMB_EXPLODE,h),this.loadAudio(l.BACKGROUND_MUSIC,a),this.loadAudio(l.AMMUNITION_EXPLODE,n)];return Promise.all(t)}loadAudio(t,i){return fetch(i).then((t=>t.arrayBuffer())).then((t=>this.audioContext.decodeAudioData(t))).then((i=>{this.audioBuffers.set(t,i)})).catch((t=>console.error(`Error loading audio file: ${i}`,t)))}play(t){const i=this.audioBuffers.get(t);if(i){const t=this.audioContext.createBufferSource();t.buffer=i,t.connect(this.audioContext.destination),t.start(0)}else console.warn(`Audio buffer for ${t} not found`)}getAudioContext(){return this.audioContext}playBackgroundMusic(){const t=this.audioBuffers.get(l.BACKGROUND_MUSIC);t?(this.stopBackgroundMusic(),this.backgroundMusicSource=this.audioContext.createBufferSource(),this.backgroundMusicSource.buffer=t,this.backgroundMusicSource.loop=!0,this.backgroundMusicSource.connect(this.audioContext.destination),this.backgroundMusicSource.start(0)):console.warn("Background music buffer not found")}stopBackgroundMusic(){this.backgroundMusicSource&&(this.backgroundMusicSource.stop(0),this.backgroundMusicSource.disconnect(),this.backgroundMusicSource=null)}}class g{}g.BABY_BLUE="#ABDEE6",g.LAVENDER_BLUSH="#CBAACB",g.PALE_YELLOW="#FFFFB5",g.PEACH_PUFF="#FFCCB6",g.BLUSH_PINK="#F3B0C3",g.LIGHT_AQUA="#C6DBDA",g.LIGHT_PINK="#FEE1E8",g.LIGHT_CORAL_PINK="#FED7C3",g.MINT_CREAM="#F6EAC2",g.PALE_LAVENDER="#ECD5E3",g.CORAL_ORANGE="#FF968A",g.SOFT_PEACH="#FFAEA5",g.LIGHT_SALMON_PINK="#FFCFB5",g.LIGHT_ROSE="#FFD8BE",g.SOFT_ORANGE="#FFC8A2",g.SOFT_TEAL="#D4F0F0",g.PALE_MINT="#8FCACA",g.LIGHT_SAGE="#CCE2CB",g.PALE_GREEN="#B6CFB6",g.MINT_GREEN="#97C1A9",g.SOFT_PEACH_PINK="#FCB9AA",g.PALE_PEACH="#FFDBCC",g.PALE_GRAY="#ECE4E4",g.PALE_AQUA="#A2E1DB",g.SOFT_CYAN="#55CBCD",g.LIGHT_LAVENDER="#E3DFFF",g.PALE_BLUE="#D4F1F9",g.LIGHT_MAUVE="#DFC9F3",g.LIGHT_LIME="#E3F6C7",g.LIGHT_GOLDENROD="#FFF8C3",g.PALE_ORANGE="#FFDAB9",g.LIGHT_YELLOW="#FFF9DB",g.LIGHT_IVORY="#FDFD96",g.LIGHT_TURQUOISE="#AFF8D8",g.LIGHT_SEA_GREEN="#D9F9B1",g.LIGHT_PERIWINKLE="#C5C6E8",g.LIGHT_VIOLET="#E1C6FF",g.LIGHT_LILAC="#F2C3E8",g.LIGHT_APRICOT="#FFE5B4",g.LIGHT_BUTTERSCOTCH="#FFD27F",g.LIGHT_MELON="#FFB7A2",g.LIGHT_TEA_GREEN="#D1F2EB",g.LIGHT_CRIMSON="#FF7F7F",g.LIGHT_PERSIAN_GREEN="#00A8A8",g.LIGHT_SKY_BLUE="#87CEFA",g.LIGHT_PASTEL_PURPLE="#C3B1E1",g.LIGHT_PASTEL_PINK="#EFB8C8",g.LIGHT_PASTEL_RED="#FFA07A",g.LIGHT_PASTEL_BLUE="#ADD8E6",g.LIGHT_PASTEL_GREEN="#98FB98",g.LIGHT_PASTEL_ORANGE="#FFDAB9",g.LIGHT_PASTEL_YELLOW="#FFFACD",g.PALE_BLACK="#A9A9A9",g.LIGHT_GRAY="#D3D3D3",g.GAINSBORO="#DCDCDC",g.PALE_SILVER="#C0C0C0",g.PALE_SMOKE="#F5F5F5",g.WHITE_SMOKE="#F5F5F5",g.OFF_WHITE="#FAF9F6",g.IVORY="#FFFFF0",g.ALABASTER="#FAEBD7",g.SEASHELL="#FFF5EE";class u{constructor(t,i,s,e,o,n,a){this.x=t,this.y=i,this.fragmentRadius=s,this.fragmentColor=e,this.velocityX=o,this.velocityY=n,this.blastRadius=a,this.life=a}update(){this.x+=this.velocityX,this.y+=this.velocityY,this.life-=1}draw(t){t.beginPath(),t.arc(this.x,this.y,this.fragmentRadius*(this.life/this.blastRadius),0,2*Math.PI,!1),t.fillStyle=this.fragmentColor,t.fill(),t.closePath()}checkHit(t){return this.x>=t.xLeft&&this.x<=t.xRight&&this.y>=t.yTop&&this.y<=t.yBottom&&this.life>0}}class y{constructor(t,i,s,o,n,a,h,r,d){this.isExploding=!1,this.radius=4,this.fragmentationRadius=10,this.fragments=[],this.fragmentColorScale=e.m4Y().domain([0,.5,1]).range([g.PALE_BLACK,g.PALE_GRAY,g.WHITE_SMOKE]),this.xPosition=t,this.yPosition=i,this.theta=s,this.speed=o,this.xVelocity=Math.cos(this.theta)*this.speed,this.yVelocity=Math.sin(this.theta)*this.speed,this.bounces=0,this.maxBounces=n,this.canvasWidth=a,this.canvasHeight=h,this.isDestroyed=r,this.audioManager=d}updatePosition(t){this.isExploding||(this.xPosition+=this.xVelocity,this.yPosition+=this.yVelocity,(this.xPosition<=0||this.xPosition>this.canvasWidth)&&(this.xVelocity=-this.xVelocity,this.bounces++),(this.yPosition<=0||this.yPosition>this.canvasHeight)&&(this.yVelocity=-this.yVelocity,this.bounces++),t.obstacles.forEach((t=>{if(this.xPosition>t.xLeft&&this.xPosition<t.xRight&&this.yPosition>t.yTop&&this.yPosition<t.yBottom){this.bounces++;const i=Math.abs(this.xPosition-t.xLeft),s=Math.abs(this.xPosition-t.xRight),e=Math.abs(this.yPosition-t.yTop),o=Math.abs(this.yPosition-t.yBottom),n=Math.min(i,s,e,o);n===e?(this.yPosition=t.yTop-1,this.yVelocity=-this.yVelocity):n===o?(this.yPosition=t.yBottom+1,this.yVelocity=-this.yVelocity):n===i?(this.xPosition=t.xLeft-1,this.xVelocity=-this.xVelocity):n===s&&(this.xPosition=t.xRight+1,this.xVelocity=-this.xVelocity)}})),this.bounces>this.maxBounces&&this.destroy())}destroy(){this.isDestroyed||this.isExploding||(this.createFragments(),this.audioManager.play(l.AMMUNITION_EXPLODE),this.isExploding=!0,setTimeout((()=>{this.isExploding=!1,this.isDestroyed=!0}),500))}checkEnemyHit(t){t.forEach((t=>{t.isDestroyed||this.xPosition>t.xLeft&&this.xPosition<t.xRight&&this.yPosition>t.yTop&&this.yPosition<t.yBottom&&(this.destroy(),t.destroy(),this.audioManager.play(l.TANK_DESTROY),console.log("Enemy hit!!!"))}))}checkPlayerHit(t){t.isDestroyed||this.xPosition>t.xLeft&&this.xPosition<t.xRight&&this.yPosition>t.yTop&&this.yPosition<t.yBottom&&(t.destroy(),this.destroy(),console.log("Player Hit!!!"))}checkAmmunitionCollision(t){for(const i of t)if(i!==this&&!i.isDestroyed){const t=this.xPosition-i.xPosition,s=this.yPosition-i.yPosition;Math.sqrt(t*t+s*s)<this.radius+i.radius&&(this.destroy(),i.destroy())}}checkBombCollision(t){for(const i of t)if(!i.isDestroyed&&!i.isExploding()){const t=this.xPosition-i.xPosition,s=this.yPosition-i.yPosition;Math.sqrt(t*t+s*s)<this.radius+i.radius&&(this.destroy(),i.destroy())}}reload(t,i,s,e,o,n){this.xPosition=t,this.yPosition=i,this.theta=s,this.isDestroyed=e,this.xVelocity=Math.cos(this.theta)*this.speed,this.yVelocity=Math.sin(this.theta)*this.speed,this.canvasWidth=o,this.canvasHeight=n,this.bounces=0}draw(t){this.isExploding?this.updateExplosion(t):(t.beginPath(),t.arc(this.xPosition,this.yPosition,this.radius,0,2*Math.PI),t.fillStyle="white",t.fill(),t.lineWidth=2,t.strokeStyle="black",t.stroke(),t.closePath())}updateExplosion(t){this.fragments.forEach((i=>{i.update(),i.draw(t)})),this.fragments=this.fragments.filter((t=>t.life>0))}createFragments(){for(let t=0;t<15;t++){const t=2*Math.random()*Math.PI,i=5*Math.random()+2,s=Math.cos(t)*i,e=Math.sin(t)*i,o=new u(this.xPosition,this.yPosition,2*Math.random()+1,this.fragmentColorScale(Math.random()),s,e,this.fragmentationRadius);this.fragments.push(o)}}willHitPlayerTank(t,i){let s=this.xPosition,e=this.yPosition,o=this.xVelocity,n=this.yVelocity,a=0;for(;a<=this.maxBounces;)if(s+=o,e+=n,(s<=0||s>this.canvasWidth)&&(o=-o,a++),(e<=0||e>this.canvasHeight)&&(n=-n,a++),t.obstacles.forEach((t=>{s>t.xLeft&&s<t.xRight&&e>t.yTop&&e<t.yBottom&&(a++,o=-o,n=-n)})),s>i.xLeft&&s<i.xRight&&e>i.yTop&&e<i.yBottom)return!0;return!1}}class v extends y{constructor(t,i,s,e,o,n,a){super(t,i,s,4,1,e,o,n,a)}}class P extends y{constructor(t,i,s,e,o,n,a){super(t,i,s,4,1,e,o,n,a)}}class p extends y{constructor(t,i,s,e,o,n,a){super(t,i,s,6,2,e,o,n,a)}}class x{constructor(t,i,s,o,n){this.radius=15,this.fragments=[],this.fragmentColorScale=e.m4Y().domain([0,.5,1]).range(["red","yellow","orange"]),this.fuseTimeoutId=null,this.xPosition=t,this.yPosition=i,this.blastRadius=s,this.isDestroyed=o,this.audioManager=n,this.blastDelayMS=6e3,this.fuseStartTime=0,this.shouldFlashRed=!1}destroy(){this.isDestroyed||this.isExploding()||(this.isDestroyed=!0,this.createFragments(),this.audioManager.play(l.BOMB_EXPLODE),null!==this.fuseTimeoutId&&(clearTimeout(this.fuseTimeoutId),this.fuseTimeoutId=null))}checkEnemyHit(t){t.forEach((t=>{if(!t.isDestroyed)for(const i of this.fragments)if(i.checkHit(t)){t.destroy();break}}))}checkPlayerHit(t){if(!t.isDestroyed)for(const i of this.fragments)if(i.checkHit(t)){t.destroy();break}}setFuse(){this.fragments=[],this.isDestroyed=!1,this.fuseStartTime=performance.now(),this.animateFuse(),this.fuseTimeoutId=window.setTimeout((()=>{this.destroy()}),this.blastDelayMS)}isTankInsideBlastRadius(t){const i=t.xPosition+t.tankMidpoint,s=t.yPosition+t.tankMidpoint,e=this.xPosition,o=this.yPosition,n=t.tankMidpoint,a=Math.max(i-n,Math.min(e,i+n))-e,h=Math.max(s-n,Math.min(o,s+n))-o;return Math.sqrt(a*a+h*h)<=this.blastRadius}isExploding(){return this.fragments.some((t=>t.life>0))}updateExplosion(t){this.fragments.forEach((i=>{i.update(),i.draw(t)})),this.fragments=this.fragments.filter((t=>t.life>0))}draw(t){this.isExploding()?this.updateExplosion(t):(t.beginPath(),t.arc(this.xPosition,this.yPosition,this.radius,0,2*Math.PI),t.fillStyle=this.shouldFlashRed?"red":"yellow",t.fill(),t.lineWidth=3,t.strokeStyle="black",t.stroke(),t.closePath(),t.beginPath(),t.arc(this.xPosition,this.yPosition,10,0,2*Math.PI),t.lineWidth=1.5,t.strokeStyle="black",t.stroke(),t.closePath())}animateFuse(){if(this.isDestroyed)return;const t=(performance.now()-this.fuseStartTime)/this.blastDelayMS;this.shouldFlashRed=[.25,.5,.625,.75,.8125,.875,.90625,.9375,.96875,.984375].some((i=>t>i&&t<i+.01)),requestAnimationFrame((()=>this.animateFuse()))}createFragments(){for(let t=0;t<50;t++){const t=2*Math.random()*Math.PI,i=5*Math.random()+2,s=Math.cos(t)*i,e=Math.sin(t)*i,o=new u(this.xPosition,this.yPosition,2*Math.random()+1,this.fragmentColorScale(Math.random()),s,e,this.blastRadius);this.fragments.push(o)}}}class f extends x{constructor(t,i,s,e){super(t,i,50,s,e)}}class w extends x{constructor(t,i,s,e){super(t,i,50,s,e)}}class E extends x{constructor(t,i,s,e){super(t,i,80,s,e)}draw(t){this.fragments.some((t=>t.life>0))?this.updateExplosion(t):(t.save(),t.translate(this.xPosition,this.yPosition),t.scale(1,1.3),t.beginPath(),t.moveTo(0,0),t.bezierCurveTo(12,-12,24,0,0,24),t.bezierCurveTo(-24,0,-12,-12,0,0),t.fillStyle=this.shouldFlashRed?"red":"#FFC2D1",t.fill(),t.lineWidth=3,t.strokeStyle="black",t.stroke(),t.closePath(),t.restore())}}class T{constructor(t){this.canvas=t,this.playerWin=!1,this.enemyWin=!1;const i=this.canvas.getContext("2d");if(!i)throw new Error("2d context not supported or canvas element not found.");this.context=i}initializeCanvas(t,i){this.canvas.width=t,this.canvas.height=i}renderLevelOverScreen(){if(!this.context)throw new Error("2d context not supported or canvas element not found.");const t=this.playerWin?"Win":this.enemyWin?"Lose":"";if(""===t)return;this.context.font="100px Arial",this.context.lineWidth=5,this.context.strokeStyle=this.playerWin?"green":"red",this.context.fillStyle=this.playerWin?"green":"red";const i=this.context.measureText(t).width,s=(this.canvas.width-i)/2,e=this.canvas.height/2+50;this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.strokeText(t,s,e),this.context.fillText(t,s,e)}render(t,i,s){if(!this.context)throw new Error("2d context not supported or canvas element not found.");this.context.clearRect(0,0,this.canvas.width,this.canvas.height),i.isDestroyed?this.enemyWin=!0:s.every((t=>t.isDestroyed))&&(this.playerWin=!0),(this.enemyWin||this.playerWin)&&this.renderLevelOverScreen();const e=[...s.flatMap((t=>t.ammunition)),...i.ammunition],o=[...s.flatMap((t=>t.bombs)),...i.bombs];i.updatePosition(i,i,s,e,o),i.aim(i.aimXPos,i.aimYPos,i),s.forEach((t=>{t.isDestroyed||(t.updatePosition(t,i,s,e,o),t.aim(t.aimXPos,t.aimYPos,i),t.shoot(i),t.plantBomb(i))})),s.forEach((t=>{t.draw(this.context),t.ammunition.forEach((s=>{s.isDestroyed||(s.checkAmmunitionCollision(e),s.checkBombCollision([...i.bombs]),s.updatePosition(t.obstacleCanvas),s.checkPlayerHit(i),s.draw(this.context))})),t.bombs.forEach((t=>{t.isDestroyed&&!t.isExploding()||(t.checkPlayerHit(i),t.draw(this.context))}))})),i.draw(this.context),i.isDestroyed||i.reticule.draw(this.context,i.xPosition,i.yPosition,i.aimXPos,i.aimYPos),i.ammunition.forEach((t=>{t.isDestroyed||(t.checkAmmunitionCollision(e),t.checkBombCollision(o),t.updatePosition(i.obstacleCanvas),t.checkEnemyHit(s),t.checkPlayerHit(i),t.draw(this.context))})),i.bombs.forEach((t=>{t.isDestroyed&&!t.isExploding()||(t.checkEnemyHit(s),t.checkPlayerHit(i),t.draw(this.context))}))}}class M{constructor(t,i,s,e){this.playerTank=null,this.enemyTanks=[],this.animationFrameID=null,this.width=i,this.height=s,this.obstacleCanvas=e,this.animationFrameID=null,this.gameRenderer=new T(document.querySelector(t)),this.gameRenderer.initializeCanvas(this.width,this.height),this.lastRenderTime=0,window.addEventListener("resize",this.resizeCanvas.bind(this))}start(){this.animationFrameID||(this.animationFrameID=requestAnimationFrame(this.gameLoop.bind(this)))}stop(){this.animationFrameID&&(cancelAnimationFrame(this.animationFrameID),this.animationFrameID=null)}resizeCanvas(){}gameLoop(t){if(null!=this.playerTank){const i=t-this.lastRenderTime;this.gameRenderer.render(i,this.playerTank,this.enemyTanks),this.lastRenderTime=t,this.animationFrameID=requestAnimationFrame(this.gameLoop.bind(this))}}addEnemyTank(t){this.enemyTanks.push(t)}addPlayerTank(t){this.playerTank=t}}class b{constructor(t,i,s,e){this.xLeft=t,this.yTop=i,this.width=s,this.height=e,this.yBottom=this.yTop+this.height,this.xRight=this.xLeft+this.width}draw(t){t.beginPath(),t.rect(this.xLeft,this.yTop,this.width,this.height),t.fillStyle="#1d1c1a",t.fill()}}class C{constructor(t,i,s,e){this.obstacles=[],this.width=i,this.height=s,this.obstacles=e,window.addEventListener("resize",this.resizeCanvas.bind(this)),this.obstacleCanvas=document.querySelector(t),this.obstacleCanvas.width=i,this.obstacleCanvas.height=s,e.forEach((t=>{t.draw(this.obstacleCanvas.getContext("2d"))}))}clearObstacles(){const t=this.obstacleCanvas.getContext("2d");t&&t.clearRect(0,0,this.obstacleCanvas.width,this.obstacleCanvas.height),this.obstacles=[]}resizeCanvas(){}}class k{}class L extends k{constructor(t){super(),this.aggressionFactor=15,this.pathRecaculationInterval=60,this.currentNode=null,this.path=[],this.navigationGrid=t}draw(t){this.navigationGrid.draw(t)}updatePosition(t,i,s,e,o){if(this.pathRecaculationInterval-=1,null==this.path||0==this.path.length||0==this.pathRecaculationInterval){this.navigationGrid.reset();const s=this.navigationGrid.getNodeFromTank(t),e=this.navigationGrid.getNodeFromTank(i),o=this.navigationGrid.getRandomNodeInRadiusOfTarget(e,this.aggressionFactor);this.path=this.navigationGrid.aStar(s,o),this.pathRecaculationInterval=60,null==this.path&&console.log("Path is null")}else{this.currentNode=this.navigationGrid.getNodeFromTank(t);const i=this.path[0].x-this.currentNode.x,s=this.path[0].y-this.currentNode.y;if(t.wasLastMoveBlocked&&t.consecutiveDirectionMoves>2){const e=t.getRandomDirection();t.moveInCardinalDirection(e),t.consecutiveDirectionMoves=0;const o=Math.random();1===i&&0===s?o<.5?t.moveSouthEast():t.moveNorthEast():-1===i&&0===s?o<.5?t.moveNorthWest():t.moveSouthWest():0===i&&1===s?o<.5?t.moveSouthEast():t.moveSouthWest():0===i&&-1===s?o<.5?t.moveNorthWest():t.moveNorthEast():1===i&&1===s?o<.5?t.moveSouth():t.moveEast():1===i&&-1===s?o<.5?t.moveNorth():t.moveEast():-1===i&&1===s?o<.5?t.moveSouth():t.moveWest():-1===i&&-1===s&&(o<.5?t.moveNorth():t.moveWest())}else 1===i&&0===s?t.moveEast():-1===i&&0===s?t.moveWest():0===i&&1===s?t.moveSouth():0===i&&-1===s?t.moveNorth():1===i&&1===s?t.moveSouthEast():1===i&&-1===s?t.moveNorthEast():-1===i&&1===s?t.moveSouthWest():-1===i&&-1===s&&t.moveNorthWest();this.path[0].x==this.currentNode.x&&this.path[0].y==this.currentNode.y&&this.path.splice(0,1)}t.xLeft=t.xPosition,t.xRight=t.xPosition+t.size,t.yTop=t.yPosition,t.yBottom=t.yPosition+t.size}}class S{constructor(t,i){this.g=0,this.h=0,this.f=0,this.walkable=!0,this.parent=null,this.x=t,this.y=i}}class A{constructor(t,i,s=!0,e="gray"){if(this.grid=[],this.gridCellWidth=30,this.path=[],this.color=e,!t||!i||s)return this.gridXLength=0,this.gridYLength=0,void(this.stationary=!0);this.stationary=!1,this.gridXLength=Math.floor(t.width/this.gridCellWidth),this.gridYLength=Math.floor(t.height/this.gridCellWidth);for(let t=0;t<this.gridXLength;t++){this.grid[t]=[];for(let s=0;s<this.gridYLength;s++){this.grid[t][s]=new S(t,s);const e=t*this.gridCellWidth,o=e+this.gridCellWidth,n=s*this.gridCellWidth,a=n+this.gridCellWidth;this.grid[t][s].walkable=!i.obstacles.some((t=>o>t.xLeft&&e<t.xRight&&a>t.yTop&&n<t.yBottom))}}}draw(t){var i;t.lineWidth=1;for(let i=0;i<=this.gridYLength;i++)t.fillStyle="blue",t.beginPath(),t.moveTo(0,i*this.gridCellWidth),t.lineTo(this.gridXLength*this.gridCellWidth,i*this.gridCellWidth),t.stroke();for(let i=0;i<=this.gridXLength;i++)t.fillStyle="blue",t.beginPath(),t.moveTo(i*this.gridCellWidth,0),t.lineTo(i*this.gridCellWidth,this.gridXLength*this.gridCellWidth),t.stroke();t.fillStyle=this.color,null===(i=this.path)||void 0===i||i.forEach(((i,s,e)=>{t.beginPath(),t.arc(i.x*this.gridCellWidth+this.gridCellWidth/2,i.y*this.gridCellWidth+this.gridCellWidth/2,5,0,2*Math.PI),t.fill()}))}reset(){for(let t=0;t<this.gridXLength;t++)for(let i=0;i<this.gridYLength;i++)this.grid[t][i].f=0,this.grid[t][i].g=0,this.grid[t][i].h=0,this.grid[t][i].parent=null}getNodeFromTank(t){let i=Math.floor((t.xPosition+t.size/2)/this.gridCellWidth),s=Math.floor((t.yPosition+t.size/2)/this.gridCellWidth);return i=Math.max(0,Math.min(i,this.gridXLength-1)),s=Math.max(0,Math.min(s,this.gridYLength-1)),this.grid[i][s]}getRandomNodeInRadiusOfTarget(t,i){const s=[];for(let e=0;e<this.gridXLength;e++)for(let o=0;o<this.gridYLength;o++){const n=this.grid[e][o],a=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));a<=i+1&&a>=i-1&&n.walkable&&s.push(n)}return s[Math.floor(Math.random()*s.length)]}aStar(t,i){const s=[t],e=new Set;for(;s.length>0;){let t=s.sort(((t,i)=>t.f-i.f))[0];if(t.x===i.x&&t.y===i.y){const i=[];for(;null!==t;)i.unshift(t),t=t.parent;return i}s.splice(s.indexOf(t),1),e.add(t);const o=this.getWalkableNeighbors(t);for(const n of o){if(e.has(n))continue;const o=t.g+(n.x-t.x==0||n.y-t.y==0?1:Math.SQRT2);if(s.includes(n)){if(o>=n.g)continue}else s.push(n);n.parent=t,n.g=o,n.h=Math.round(Math.sqrt(Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2))),n.f=n.g+n.h}}return null}getWalkableNeighbors(t){const i=[];for(let s=-1;s<=1;s++)for(let e=-1;e<=1;e++){if(0===s&&0===e)continue;const o=t.x+s,n=t.y+e;o>=0&&n>=0&&o<this.gridXLength&&n<this.gridYLength&&this.grid[o][n].walkable&&i.push(this.grid[o][n])}return i}}class D extends k{constructor(t){super(),this.pathRecaculationInterval=120,this.aggressionFactor=10,this.currentNode=null,this.path=[],this.simplePathFinder=t}draw(t){}updatePosition(t,i,s,e,o){if(this.pathRecaculationInterval-=1,null==this.path||0==this.path.length||0==this.pathRecaculationInterval){const s=this.simplePathFinder.getNodeFromTank(t),e=this.simplePathFinder.getNodeFromTank(i),o=this.simplePathFinder.getRandomNodeInRadiusOfTarget(e,this.aggressionFactor);this.pathRecaculationInterval=120,this.path=this.simplePathFinder.findPath(s,o)}else{this.currentNode=this.simplePathFinder.getNodeFromTank(t);const i=this.path[0].x-this.currentNode.x,s=this.path[0].y-this.currentNode.y;this.path&&this.path.length>1&&(1===i&&0===s?t.moveEast():-1===i&&0===s?t.moveWest():0===i&&1===s?t.moveSouth():0===i&&-1===s?t.moveNorth():1===i&&1===s?t.moveSouthEast():1===i&&-1===s?t.moveNorthEast():-1===i&&1===s?t.moveSouthWest():-1===i&&-1===s&&t.moveNorthWest()),this.path[0].x==this.currentNode.x&&this.path[0].y==this.currentNode.y&&this.path.splice(0,1)}t.xLeft=t.xPosition,t.xRight=t.xPosition+t.size,t.yTop=t.yPosition,t.yBottom=t.yPosition+t.size}}class B{constructor(t,i,s=!0){if(this.grid=[],this.gridCellWidth=30,this.path=[],!t||!i||s)return this.gridXLength=0,this.gridYLength=0,void(this.stationary=!0);this.stationary=!1,this.gridXLength=Math.floor(t.width/this.gridCellWidth),this.gridYLength=Math.floor(t.height/this.gridCellWidth);for(let t=0;t<this.gridXLength;t++){this.grid[t]=[];for(let s=0;s<this.gridYLength;s++){this.grid[t][s]=new S(t,s);const e=t*this.gridCellWidth,o=e+this.gridCellWidth,n=s*this.gridCellWidth,a=n+this.gridCellWidth;this.grid[t][s].walkable=!i.obstacles.some((t=>o>t.xLeft&&e<t.xRight&&a>t.yTop&&n<t.yBottom))}}}moveTowardsGoal(t,i){if(t===i)return t;const s=[new S(t.x+1,t.y),new S(t.x-1,t.y),new S(t.x,t.y+1),new S(t.x,t.y-1)];let e=t,o=Number.MAX_SAFE_INTEGER;for(const t of s)if(this.isWithinBounds(t)&&this.isWalkable(t)){const s=Math.abs(t.x-i.x)+Math.abs(t.y-i.y);s<o&&(o=s,e=t)}return e}isWithinBounds(t){return 0<=t.x&&t.x<this.gridXLength&&0<=t.y&&t.y<this.gridYLength}isWalkable(t){return this.grid[t.x][t.y].walkable}findPath(t,i){let s=t;const e=[s];let o=10;for(;o>0;)s=this.moveTowardsGoal(s,i),e.push(s),o--;return e}getNodeFromTank(t){let i=Math.floor((t.xPosition+t.size/2)/this.gridCellWidth),s=Math.floor((t.yPosition+t.size/2)/this.gridCellWidth);return i=Math.max(0,Math.min(i,this.gridXLength-1)),s=Math.max(0,Math.min(s,this.gridYLength-1)),this.grid[i][s]}getRandomNodeInRadiusOfTarget(t,i){const s=[];for(let e=0;e<this.gridXLength;e++)for(let o=0;o<this.gridYLength;o++){const n=this.grid[e][o],a=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));a<=i+1&&a>=i-1&&n.walkable&&s.push(n)}return s[Math.floor(Math.random()*s.length)]}}class R{constructor(t,i,s,e){this.reticuleWidth=5,this.color=i,this.dashPattern=t,this.renderReticule=s,this.tankSize=e}draw(t,i,s,e,o){this.renderReticule&&(t.strokeStyle=this.color,t.setLineDash(this.dashPattern),t.beginPath(),t.moveTo(i+this.tankSize/2,s+this.tankSize/2),t.lineTo(e,o),t.lineWidth=this.reticuleWidth,t.stroke())}}class F extends R{constructor(){super([0,0],"blue",!1,0)}}class I extends R{constructor(t,i,s){super([1,1],i,!0,t),this.maxReticuleLength=s}draw(t,i,s,e,o){const n=e-i,a=o-s,h=Math.sqrt(Math.pow(n,2)+Math.pow(a,2))/this.maxReticuleLength,r=10*h+2,d=10*(1-h)+5;if(this.renderReticule){t.strokeStyle=this.color,t.setLineDash([r,d]),t.beginPath(),t.moveTo(i+this.tankSize/2,s+this.tankSize/2),t.lineTo(e,o),t.lineWidth=this.reticuleWidth,t.stroke(),t.setLineDash([]);const n=8;t.beginPath(),t.moveTo(e-n,o-n),t.lineTo(e+n,o+n),t.stroke(),t.beginPath(),t.moveTo(e-n,o+n),t.lineTo(e+n,o-n),t.stroke()}}}!function(t){t[t.NORTH=1]="NORTH",t[t.SOUTH=2]="SOUTH",t[t.EAST=3]="EAST",t[t.WEST=4]="WEST",t[t.NORTHEAST=5]="NORTHEAST",t[t.NORTHWEST=6]="NORTHWEST",t[t.SOUTHEAST=7]="SOUTHEAST",t[t.SOUTHWEST=8]="SOUTHWEST",t[t.UNKNOWN=9]="UNKNOWN"}(c||(c={}));class N{constructor(t,i,s,e,o,n,a,h,r,d,l){this.gunBarrellWidth=7,this.isDestroyed=!1,this.isExploding=!1,this.twoPi=2*Math.PI,this.lastDirectionMoved=c.UNKNOWN,this.wasLastMoveBlocked=!1,this.consecutiveDirectionMoves=0,this.ammunition=[],this.bombs=[],this.reticule=i,this.xPosition=s,this.yPosition=e,this.xLeft=s,this.xRight=s+n,this.yTop=e,this.yBottom=e+n,this.speed=o,this.size=n,this.color=a,this.canvasWidth=t.width,this.canvasHeight=t.height,this.obstacleCanvas=h,this.tankMidpoint=this.size/2,this.ammunition=r,this.maxAmmunition=r.length,this.bombs=d,this.maxBombs=d.length,this.audioManager=l;const m=t.getBoundingClientRect();this.xOffset=m.left,this.yOffset=m.top,this.aimXPos=t.width/2,this.aimYPos=t.height/2;const g=this.aimXPos-this.xPosition-this.tankMidpoint,u=this.aimYPos-this.yPosition-this.tankMidpoint;let y=Math.atan2(u,g);y<0&&(y+=2*Math.PI),this.aimAngle=y,this.gunBarrellEndX=this.xPosition+this.tankMidpoint+Math.cos(this.aimAngle)*this.size,this.gunBarrellEndY=this.yPosition+this.tankMidpoint+Math.sin(this.aimAngle)*this.size,this.fragments=[]}draw(t){if(this.isDestroyed){this.isExploding&&this.updateExplosion(t),t.strokeStyle=this.color,t.lineWidth=5,t.setLineDash([]);const i=12;t.beginPath(),t.moveTo(this.xPosition+this.tankMidpoint-i,this.yPosition+this.tankMidpoint-i),t.lineTo(this.xPosition+this.tankMidpoint+i,this.yPosition+this.tankMidpoint+i),t.stroke(),t.beginPath(),t.moveTo(this.xPosition+this.tankMidpoint-i,this.yPosition+this.tankMidpoint+i),t.lineTo(this.xPosition+this.tankMidpoint+i,this.yPosition+this.tankMidpoint-i),t.stroke()}else t.fillStyle=this.color,t.fillRect(this.xPosition,this.yPosition,this.size,this.size),t.setLineDash([]),t.lineJoin="bevel",t.strokeStyle="black",t.lineWidth=2,t.strokeRect(this.xPosition,this.yPosition,this.size,this.size),t.beginPath(),t.arc(this.xPosition+this.tankMidpoint,this.yPosition+this.tankMidpoint,this.size/3,0,this.twoPi),t.stroke(),this.gunBarrellEndX=this.xPosition+this.tankMidpoint+Math.cos(this.aimAngle)*this.size,this.gunBarrellEndY=this.yPosition+this.tankMidpoint+Math.sin(this.aimAngle)*this.size,t.beginPath(),t.moveTo(this.xPosition+this.tankMidpoint,this.yPosition+this.tankMidpoint),t.lineTo(this.gunBarrellEndX,this.gunBarrellEndY),t.lineWidth=this.gunBarrellWidth,t.stroke()}destroy(){this.isDestroyed=!0,this.isExploding=!0,this.createFragments(),setTimeout((()=>{this.isExploding=!1}),1e3)}createFragments(){for(let t=0;t<50;t++){const t=2*Math.random()*Math.PI,i=5*Math.random()+2,s=Math.cos(t)*i,e=Math.sin(t)*i,o=Math.floor(256*Math.random()),n=`rgba(${o}, ${o}, ${o}, ${.5*Math.random()+.5})`,a=new u(this.xPosition+this.tankMidpoint,this.yPosition+this.tankMidpoint,2*Math.random()+1,n,s,e,10);this.fragments.push(a)}}updateExplosion(t){this.fragments.forEach((i=>{i.update(),i.draw(t)})),this.fragments=this.fragments.filter((t=>t.life>0))}updatePosition(t,i,s,e,o){}aim(t,i,s){}shoot(t){}plantBomb(t){}moveInLastDirectionMoved(){this.moveInCardinalDirection(this.lastDirectionMoved)}getRandomDirection(){const t=Object.keys(c).map((t=>Number.parseInt(t))).filter((t=>!Number.isNaN(t)));return t[Math.floor(Math.random()*t.length)]}moveInCardinalDirection(t){if(!this.isDestroyed)switch(t){case c.NORTH:this.moveNorth();break;case c.SOUTH:this.moveSouth();break;case c.EAST:this.moveEast();break;case c.WEST:this.moveWest();break;case c.NORTHEAST:this.moveNorthEast();break;case c.NORTHWEST:this.moveNorthWest();break;case c.SOUTHEAST:this.moveSouthEast();break;case c.SOUTHWEST:this.moveSouthWest();break;default:{const t=Object.values(c).filter((t=>"number"==typeof t)),i=Math.floor(Math.random()*t.length);this.moveInCardinalDirection(t[i]);break}}}moveNorth(){if(this.isDestroyed)return;this.lastDirectionMoved==c.NORTH?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.NORTH;let t=!1;for(const i of this.obstacleCanvas.obstacles)if(this.yPosition-this.speed<i.yTop+i.height&&this.yPosition>i.yTop&&i.xLeft<this.xPosition+this.size&&this.xPosition<i.xRight){this.yPosition=i.yBottom,t=!0;break}t?this.wasLastMoveBlocked=!0:this.yPosition=Math.max(this.yPosition-this.speed,0)}moveSouth(){if(this.isDestroyed)return;this.lastDirectionMoved==c.SOUTH?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.SOUTH;let t=!1;for(const i of this.obstacleCanvas.obstacles)if(this.yPosition+this.speed+this.size>i.yTop&&this.yPosition<i.yTop+i.height&&i.xLeft<this.xPosition+this.size&&this.xPosition<i.xRight){this.yPosition=i.yTop-this.size,t=!0;break}t?this.wasLastMoveBlocked=!0:this.yPosition=Math.min(this.yPosition+this.speed,this.canvasHeight-this.size)}moveWest(){if(this.isDestroyed)return;this.lastDirectionMoved==c.WEST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.WEST;let t=!1;for(const i of this.obstacleCanvas.obstacles)if(this.xPosition-this.speed<i.xRight&&this.xPosition>i.xLeft&&i.yTop<this.yPosition+this.size&&this.yPosition<i.yBottom){this.xPosition=i.xRight,t=!0;break}t?this.wasLastMoveBlocked=!0:this.xPosition=Math.max(this.xPosition-this.speed,0)}moveEast(){if(this.isDestroyed)return;this.lastDirectionMoved==c.EAST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.EAST;let t=!1;for(const i of this.obstacleCanvas.obstacles)if(this.xPosition+this.speed+this.size>i.xLeft&&this.xPosition<i.xLeft+i.width&&i.yTop<this.yPosition+this.size&&this.yPosition<i.yBottom){this.xPosition=i.xLeft-this.size,t=!0;break}t?this.wasLastMoveBlocked=!0:this.xPosition=Math.min(this.xPosition+this.speed,this.canvasWidth-this.size)}moveNorthEast(){if(this.isDestroyed)return;this.lastDirectionMoved==c.NORTHEAST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.NORTHEAST;let t=!1,i=!1;for(const s of this.obstacleCanvas.obstacles)!t&&this.yPosition-this.speed<s.yTop+s.height&&this.yPosition>s.yTop&&s.xLeft<this.xPosition+this.size&&this.xPosition<s.xRight&&(this.yPosition=s.yBottom,t=!0),!i&&this.xPosition+this.speed+this.size>s.xLeft&&this.xPosition<s.xLeft+s.width&&s.yTop<this.yPosition+this.size&&this.yPosition<s.yBottom&&(this.xPosition=s.xLeft-this.size,i=!0);t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPosition=Math.max(this.yPosition-this.speed,0)),i||(this.xPosition=Math.min(this.xPosition+this.speed,this.canvasWidth-this.size))}moveNorthWest(){if(this.isDestroyed)return;this.lastDirectionMoved==c.NORTHWEST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.NORTHWEST;let t=!1,i=!1;for(const s of this.obstacleCanvas.obstacles)!t&&this.yPosition-this.speed<s.yTop+s.height&&this.yPosition>s.yTop&&s.xLeft<this.xPosition+this.size&&this.xPosition<s.xRight&&(this.yPosition=s.yBottom,t=!0),!i&&this.xPosition-this.speed<s.xRight&&this.xPosition>s.xLeft&&s.yTop<this.yPosition+this.size&&this.yPosition<s.yBottom&&(this.xPosition=s.xRight,i=!0);t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPosition=Math.max(this.yPosition-this.speed,0)),i||(this.xPosition=Math.max(this.xPosition-this.speed,0))}moveSouthEast(){if(this.isDestroyed)return;this.lastDirectionMoved==c.SOUTHEAST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.SOUTHEAST;let t=!1,i=!1;for(const s of this.obstacleCanvas.obstacles)!t&&this.yPosition+this.speed+this.size>s.yTop&&this.yPosition<s.yTop+s.height&&s.xLeft<this.xPosition+this.size&&this.xPosition<s.xRight&&(this.yPosition=s.yTop-this.size,t=!0),!i&&this.xPosition+this.speed+this.size>s.xLeft&&this.xPosition<s.xLeft+s.width&&s.yTop<this.yPosition+this.size&&this.yPosition<s.yBottom&&(this.xPosition=s.xLeft-this.size,i=!0);t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPosition=Math.min(this.yPosition+this.speed,this.canvasHeight-this.size)),i||(this.xPosition=Math.min(this.xPosition+this.speed,this.canvasWidth-this.size))}moveSouthWest(){if(this.isDestroyed)return;this.lastDirectionMoved==c.SOUTHWEST?this.consecutiveDirectionMoves+=1:this.consecutiveDirectionMoves=0,this.lastDirectionMoved=c.SOUTHWEST;let t=!1,i=!1;for(const s of this.obstacleCanvas.obstacles)!t&&this.yPosition+this.speed+this.size>s.yTop&&this.yPosition<s.yTop+s.height&&s.xLeft<this.xPosition+this.size&&this.xPosition<s.xRight&&(this.yPosition=s.yTop-this.size,t=!0),!i&&this.xPosition-this.speed<s.xRight&&this.xPosition>s.xLeft&&s.yTop<this.yPosition+this.size&&this.yPosition<s.yBottom&&(this.xPosition=s.xRight,i=!0);t&&i&&(this.wasLastMoveBlocked=!0),t||(this.yPosition=Math.min(this.yPosition+this.speed,this.canvasHeight-this.size)),i||(this.xPosition=Math.max(this.xPosition-this.speed,0))}}class W extends N{constructor(t,i,s,e,o,n,a,h,r,d,l,c,m){super(t,i,s,e,o,n,h,r,d,l,c),this.aggressionFactor=15,this.path=[],this.pathRecaculationInterval=60,this.drawNavigation=!1,this.aggressionFactor=a,this.navigator=m}draw(t){this.drawNavigation&&this.navigator.draw(t),super.draw(t)}updatePosition(t,i,s,e,o){this.navigator.updatePosition(t,i,s,e,o)}}class H extends W{constructor(t,i,s,e,o,n,a,h){const r=g.PALE_YELLOW;super(t,new F,i,s,2,30,4,r,e,o,n,h,a),this.minTimeBetweenShotsMS=2e4,this.timeBetweenShotsIsElapsed=!0,this.minTimeBetweenBombPlantsMS=1e3,this.timeBetweenPlantsIsElapsed=!0}plantBomb(t){if(this.timeBetweenPlantsIsElapsed&&!this.isDestroyed){const i=this.bombs.findIndex((t=>t.isDestroyed&&!t.isExploding()));if(-1!==i){this.bombs[i].xPosition=this.xPosition+this.size/2,this.bombs[i].yPosition=this.yPosition+this.size/2;this.bombs[i].isTankInsideBlastRadius(t)&&(this.bombs[i].setFuse(),this.timeBetweenPlantsIsElapsed=!1,setTimeout((()=>{this.timeBetweenPlantsIsElapsed=!0}),this.minTimeBetweenBombPlantsMS))}}}shoot(t){if(this.timeBetweenShotsIsElapsed&&!this.isDestroyed){const i=this.ammunition.findIndex((t=>t.isDestroyed));if(-1!==i){this.ammunition[i].reload(this.gunBarrellEndX,this.gunBarrellEndY,this.aimAngle,!0,this.canvasWidth,this.canvasHeight);this.ammunition[i].willHitPlayerTank(this.obstacleCanvas,t)&&(this.ammunition[i].isDestroyed=!1,this.timeBetweenShotsIsElapsed=!1,setTimeout((()=>{this.timeBetweenShotsIsElapsed=!0}),this.minTimeBetweenShotsMS))}}}aim(t,i,s){if(this.isDestroyed)return;const e=s.xPosition+s.size/2-this.xPosition-this.tankMidpoint,o=s.yPosition+s.size/2-this.yPosition-this.tankMidpoint;let n=Math.atan2(o,e);n<0&&(n+=2*Math.PI),this.aimAngle=n}}class O extends N{constructor(t,i,s,e,o,n,a,h,r,d,l){super(t,i,s,e,o,n,a,h,r,d,l),this.keyStates={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1,w:!1,a:!1,s:!1,d:!1,W:!1,A:!1,S:!1,D:!1},document.addEventListener("keydown",(t=>{this.keyStates.hasOwnProperty(t.key)&&(this.keyStates[t.key]=!0)})),document.addEventListener("keydown",(t=>{"Space"===t.code&&this.plantBomb(this)})),document.addEventListener("keyup",(t=>{this.keyStates.hasOwnProperty(t.key)&&(this.keyStates[t.key]=!1)})),document.addEventListener("mousemove",(t=>{this.aimXPos=t.clientX-this.xOffset,this.aimYPos=t.clientY-this.yOffset})),document.addEventListener("click",(i=>{t.contains(i.target)&&this.shoot(this)}))}updatePosition(t,i,s,e,o){this.up()&&this.right()?this.moveNorthEast():this.up()&&this.left()?this.moveNorthWest():this.down()&&this.right()?this.moveSouthEast():this.down()&&this.left()?this.moveSouthWest():this.up()?this.moveNorth():this.down()?this.moveSouth():this.left()?this.moveWest():this.right()&&this.moveEast(),this.xLeft=this.xPosition,this.xRight=this.xPosition+this.size,this.yTop=this.yPosition,this.yBottom=this.yPosition+this.size}plantBomb(t){if(this.isDestroyed)return;const i=this.bombs.findIndex((t=>t.isDestroyed&&!t.isExploding()));-1!==i&&(this.bombs[i].xPosition=this.xPosition+this.size/2,this.bombs[i].yPosition=this.yPosition+this.size/2,this.bombs[i].setFuse())}aim(t,i,s){if(this.isDestroyed)return;const e=t-this.xPosition-this.tankMidpoint,o=i-this.yPosition-this.tankMidpoint;let n=Math.atan2(o,e);n<0&&(n+=2*Math.PI),this.aimAngle=n}shoot(t){if(!this.isDestroyed){const t=this.ammunition.findIndex((t=>t.isDestroyed));-1!==t&&(this.audioManager.play(l.TANK_FIRE),this.ammunition[t]=new v(this.gunBarrellEndX,this.gunBarrellEndY,this.aimAngle,this.canvasWidth,this.canvasHeight,!1,this.audioManager))}}up(){return this.keyStates.ArrowUp||this.keyStates.w||this.keyStates.W}down(){return this.keyStates.ArrowDown||this.keyStates.s||this.keyStates.S}left(){return this.keyStates.ArrowLeft||this.keyStates.a||this.keyStates.A}right(){return this.keyStates.ArrowRight||this.keyStates.d||this.keyStates.D}}class _ extends O{constructor(t,i,s,e,o){const n="#4f6d7a",a=[new v(0,0,0,0,0,!0,o),new v(0,0,0,0,0,!0,o),new v(0,0,0,0,0,!0,o),new v(0,0,0,0,0,!0,o),new v(0,0,0,0,0,!0,o)],h=[new f(0,0,!0,o),new f(0,0,!0,o)],r=t.getBoundingClientRect(),d=window.innerWidth,l=r.left,c=d-r.right,m=t.width+Math.max(l,c);super(t,new I(30,n,m),i,s,2,30,n,e,a,h,o)}}class z extends W{constructor(t,i,s,e,o,n,a,h){const r=g.CORAL_ORANGE;super(t,new F,i,s,1.2,30,15,r,e,o,n,h,a)}shoot(t){const i=this.ammunition.findIndex((t=>t.isDestroyed));if(-1!==i){this.ammunition[i].reload(this.gunBarrellEndX,this.gunBarrellEndY,this.aimAngle,!0,this.canvasWidth,this.canvasHeight);this.ammunition[i].willHitPlayerTank(this.obstacleCanvas,t)&&(this.ammunition[i].isDestroyed=!1)}}aim(t,i,s){if(this.isDestroyed)return;const e=s.xPosition+s.size/2-this.xPosition-this.tankMidpoint,o=s.yPosition+s.size/2-this.yPosition-this.tankMidpoint;let n=Math.atan2(o,e);n<0&&(n+=2*Math.PI),this.aimAngle=n}}class G extends k{constructor(){super(...arguments),this.aggressionFactor=0}draw(t){}updatePosition(t,i,s,e,o){}}class Y extends W{constructor(t,i,s,e,o,n){const a=g.BABY_BLUE,h=new G;super(t,new F,i,s,0,30,0,a,e,o,[],n,h),this.aimAngleChangeAmount=0}getAngleChangeAmount(){return Math.floor(721*Math.random())+-360}updatePosition(t){}shoot(t){const i=this.ammunition.findIndex((t=>t.isDestroyed));if(-1!==i){this.ammunition[i].reload(this.gunBarrellEndX,this.gunBarrellEndY,this.aimAngle,!0,this.canvasWidth,this.canvasHeight);this.ammunition[i].willHitPlayerTank(this.obstacleCanvas,t)&&(this.ammunition[i].isDestroyed=!1)}}aim(t,i,s){this.isDestroyed||(this.aimAngleChangeAmount>0?(this.aimAngle+=.01,this.aimAngleChangeAmount-=1):this.aimAngleChangeAmount<0?(this.aimAngle-=.01,this.aimAngleChangeAmount+=1):this.aimAngleChangeAmount=this.getAngleChangeAmount())}}class U extends W{constructor(t,i,s,e,o){const n=g.PALE_GRAY,a=[new P(0,0,0,0,0,!0,o)],h=new G;super(t,new F,i,s,0,30,0,n,e,a,[],o,h),this.minTimeBetweenShotsMS=5e3,this.timeBetweenShotsIsElapsed=!1,setTimeout((()=>{this.timeBetweenShotsIsElapsed=!0}),1e3)}updatePosition(t){}shoot(t){if(!this.timeBetweenShotsIsElapsed||this.isDestroyed)return;const i=this.ammunition.findIndex((t=>t.isDestroyed));if(-1!==i){this.ammunition[i].reload(this.gunBarrellEndX,this.gunBarrellEndY,this.aimAngle,!0,this.canvasWidth,this.canvasHeight);this.ammunition[i].willHitPlayerTank(this.obstacleCanvas,t)&&(this.ammunition[i].isDestroyed=!1,this.timeBetweenShotsIsElapsed=!1,setTimeout((()=>{this.timeBetweenShotsIsElapsed=!0}),this.minTimeBetweenShotsMS))}}aim(t,i,s){if(this.isDestroyed)return;const e=s.xPosition+s.size/2-this.xPosition-this.tankMidpoint,o=s.yPosition+s.size/2-this.yPosition-this.tankMidpoint;let n=Math.atan2(o,e);n<0&&(n+=2*Math.PI),this.aimAngle=n}}class X extends W{constructor(t,i,s,e,o,n,a,h){const r=g.BLUSH_PINK;super(t,new F,i,s,2.2,30,5,r,e,o,n,h,a),this.minTimeBetweenShotsMS=1e3,this.timeBetweenShotsIsElapsed=!1,this.minTimeBetweenBombPlantsMS=1e3,this.timeBetweenPlantsIsElapsed=!0,setTimeout((()=>{this.timeBetweenShotsIsElapsed=!0}),1e3)}plantBomb(t){if(this.timeBetweenPlantsIsElapsed&&!this.isDestroyed){const i=this.bombs.findIndex((t=>t.isDestroyed&&!t.isExploding()));if(-1!==i){this.bombs[i].xPosition=this.xPosition+this.size/2,this.bombs[i].yPosition=this.yPosition+this.size/2;this.bombs[i].isTankInsideBlastRadius(t)&&(this.bombs[i].setFuse(),this.timeBetweenPlantsIsElapsed=!1,setTimeout((()=>{this.timeBetweenPlantsIsElapsed=!0}),this.minTimeBetweenBombPlantsMS))}}}shoot(t){if(this.timeBetweenShotsIsElapsed&&!this.isDestroyed){const i=this.ammunition.findIndex((t=>t.isDestroyed));if(-1!==i){this.ammunition[i].reload(this.gunBarrellEndX,this.gunBarrellEndY,this.aimAngle,!0,this.canvasWidth,this.canvasHeight);this.ammunition[i].willHitPlayerTank(this.obstacleCanvas,t)&&(this.ammunition[i].isDestroyed=!1,this.timeBetweenShotsIsElapsed=!1,setTimeout((()=>{this.timeBetweenShotsIsElapsed=!0}),this.minTimeBetweenShotsMS))}}}aim(t,i,s){if(this.isDestroyed)return;const e=s.xPosition+s.size/2-this.xPosition-this.tankMidpoint,o=s.yPosition+s.size/2-this.yPosition-this.tankMidpoint;let n=Math.atan2(o,e);n<0&&(n+=2*Math.PI),this.aimAngle=n}}class K{constructor(t,i){this.canvasWidth=1e3,this.canvasHeight=500,this.obstacleCanvas=t,this.gameCanvas=new M("#game-canvas",this.canvasWidth,this.canvasHeight,t),this.audioManager=i}stop(){this.gameCanvas.stop()}start(){this.gameCanvas.start()}}class V extends K{constructor(t){const i=new b(300,200,40,100),s=new C("#obstacle-canvas",1e3,500,[i]);super(s,t);const e=new U(this.gameCanvas.gameRenderer.canvas,900,240,s,t);this.gameCanvas.addEnemyTank(e);const o=new _(this.gameCanvas.gameRenderer.canvas,100,250,s,t);this.gameCanvas.addPlayerTank(o)}}class q extends K{constructor(t){const i=new b(300,200,40,100),s=new C("#obstacle-canvas",1e3,500,[i]);super(s,t);const e=new U(this.gameCanvas.gameRenderer.canvas,800,100,s,t),o=new U(this.gameCanvas.gameRenderer.canvas,900,240,s,t),n=new U(this.gameCanvas.gameRenderer.canvas,800,400,s,t);this.gameCanvas.addEnemyTank(e),this.gameCanvas.addEnemyTank(o),this.gameCanvas.addEnemyTank(n);const a=new _(this.gameCanvas.gameRenderer.canvas,100,250,s,t);this.gameCanvas.addPlayerTank(a)}}class $ extends K{constructor(t){const i=new b(700,150,30,250),s=new C("#obstacle-canvas",1e3,500,[i]);super(s,t);const e=[new p(0,0,0,0,0,!0,t)],o=new Y(this.gameCanvas.gameRenderer.canvas,900,250,s,e,t);this.gameCanvas.addEnemyTank(o);const n=new _(this.gameCanvas.gameRenderer.canvas,200,250,s,t);this.gameCanvas.addPlayerTank(n)}}class j extends K{constructor(t){const i=new b(300,130,500,35),s=new b(200,330,500,35),e=new C("#obstacle-canvas",1e3,500,[i,s]);super(e,t);const o=[new P(0,0,0,0,0,!0,t)],n=new B(this.gameCanvas,this.obstacleCanvas,!1),a=new D(n),h=new z(this.gameCanvas.gameRenderer.canvas,900,50,e,o,[],a,t);this.gameCanvas.addEnemyTank(h);const r=new _(this.gameCanvas.gameRenderer.canvas,50,450,e,t);this.gameCanvas.addPlayerTank(r)}}class Q extends K{constructor(t){const i=new b(100,100,200,100),s=new b(700,100,30,100),e=new b(700,350,30,100),o=new C("#obstacle-canvas",1e3,500,[i,s,e]);super(o,t);const n=[new P(0,0,0,0,0,!0,t)],a=[new p(0,0,0,0,0,!0,t)],h=new A(this.gameCanvas,this.obstacleCanvas,!1),r=new L(h),d=new z(this.gameCanvas.gameRenderer.canvas,800,300,o,n,[],r,t),l=new Y(this.gameCanvas.gameRenderer.canvas,800,100,o,a,t),c=new U(this.gameCanvas.gameRenderer.canvas,800,200,o,t);this.gameCanvas.addEnemyTank(d),this.gameCanvas.addEnemyTank(l),this.gameCanvas.addEnemyTank(c);const m=new _(this.gameCanvas.gameRenderer.canvas,200,250,o,t);this.gameCanvas.addPlayerTank(m)}}class J extends K{constructor(t){const i=new b(100,100,200,100),s=new b(700,100,30,300),e=new C("#obstacle-canvas",1e3,500,[i,s]);super(e,t);const o=[new w(0,0,!0,t),new w(0,0,!0,t),new w(0,0,!0,t)],n=[new w(0,0,!0,t),new w(0,0,!0,t),new w(0,0,!0,t)],a=[new w(0,0,!0,t),new w(0,0,!0,t),new w(0,0,!0,t)],h=new A(this.gameCanvas,this.obstacleCanvas,!1),r=new A(this.gameCanvas,this.obstacleCanvas,!1),d=new A(this.gameCanvas,this.obstacleCanvas,!1),l=new L(h),c=new L(r),m=new L(d),g=new H(this.gameCanvas.gameRenderer.canvas,800,100,e,[new P(0,0,0,0,0,!0,t)],o,l,t),u=new H(this.gameCanvas.gameRenderer.canvas,800,200,e,[new P(0,0,0,0,0,!0,t)],n,c,t),y=new H(this.gameCanvas.gameRenderer.canvas,800,300,e,[new P(0,0,0,0,0,!0,t)],a,m,t);this.gameCanvas.addEnemyTank(g),this.gameCanvas.addEnemyTank(u),this.gameCanvas.addEnemyTank(y);const v=new _(this.gameCanvas.gameRenderer.canvas,200,250,e,t);this.gameCanvas.addPlayerTank(v)}}class Z extends K{constructor(t){const i=new b(0,120,400,50),s=new b(600,120,400,50),e=new b(0,330,400,50),o=new b(600,330,400,50),n=new C("#obstacle-canvas",1e3,500,[i,s,e,o]);super(n,t);const a=[new p(0,0,0,0,0,!0,t)],h=new Y(this.gameCanvas.gameRenderer.canvas,900,50,n,a,t),r=[new p(0,0,0,0,0,!0,t)],d=new Y(this.gameCanvas.gameRenderer.canvas,900,250,n,r,t),l=[new p(0,0,0,0,0,!0,t)],c=new Y(this.gameCanvas.gameRenderer.canvas,900,430,n,l,t),m=[new p(0,0,0,0,0,!0,t)],g=new Y(this.gameCanvas.gameRenderer.canvas,100,50,n,m,t),u=[new p(0,0,0,0,0,!0,t)],y=new Y(this.gameCanvas.gameRenderer.canvas,100,250,n,u,t);this.gameCanvas.addEnemyTank(h),this.gameCanvas.addEnemyTank(d),this.gameCanvas.addEnemyTank(c),this.gameCanvas.addEnemyTank(g),this.gameCanvas.addEnemyTank(y);const v=new _(this.gameCanvas.gameRenderer.canvas,100,430,n,t);this.gameCanvas.addPlayerTank(v)}}class tt extends K{constructor(t){const i=new b(700,100,30,300),s=new C("#obstacle-canvas",1e3,500,[i]);super(s,t);const e=[new p(0,0,0,0,0,!0,t),new p(0,0,0,0,0,!0,t),new p(0,0,0,0,0,!0,t)],o=[new p(0,0,0,0,0,!0,t),new p(0,0,0,0,0,!0,t),new p(0,0,0,0,0,!0,t)],n=[new p(0,0,0,0,0,!0,t),new p(0,0,0,0,0,!0,t),new p(0,0,0,0,0,!0,t)],a=[new E(0,0,!0,t),new E(0,0,!0,t)],h=[new E(0,0,!0,t),new E(0,0,!0,t)],r=[new E(0,0,!0,t),new E(0,0,!0,t)],d=new A(this.gameCanvas,this.obstacleCanvas,!1),l=new A(this.gameCanvas,this.obstacleCanvas,!1),c=new A(this.gameCanvas,this.obstacleCanvas,!1),m=new L(d);m.aggressionFactor=5;const g=new L(l);g.aggressionFactor=10;const u=new L(c);u.aggressionFactor=15;const y=new X(this.gameCanvas.gameRenderer.canvas,800,100,s,e,a,m,t),v=new X(this.gameCanvas.gameRenderer.canvas,800,200,s,o,h,g,t),P=new X(this.gameCanvas.gameRenderer.canvas,800,300,s,n,r,u,t);this.gameCanvas.addEnemyTank(y),this.gameCanvas.addEnemyTank(v),this.gameCanvas.addEnemyTank(P);const x=new _(this.gameCanvas.gameRenderer.canvas,200,250,s,t);this.gameCanvas.addPlayerTank(x)}}new class{constructor(t){this.sliderWidth=Math.min(.8*window.innerWidth,600),this.numLevels=t,this.audioManager=new m;this.audioManager.loadAllAudio().then((()=>{this.audioManager.playBackgroundMusic()})),this.activeLevelNumber=1,this.activeLevel=new V(this.audioManager),this.setHeader(),this.createSlider(),this.createJumbotron()}setHeader(){const t=document.getElementById("main-header");t&&(t.textContent=`Treads V${o}`)}startActiveLevel(){switch(this.activeLevel.stop(),this.activeLevelNumber){case 1:default:this.activeLevel=new V(this.audioManager);break;case 2:this.activeLevel=new q(this.audioManager);break;case 3:this.activeLevel=new $(this.audioManager);break;case 4:this.activeLevel=new j(this.audioManager);break;case 5:this.activeLevel=new Q(this.audioManager);break;case 6:this.activeLevel=new J(this.audioManager);break;case 7:this.activeLevel=new Z(this.audioManager);break;case 8:this.activeLevel=new tt(this.audioManager)}this.activeLevel.start()}createSlider(){const t=10,i=10,s=this.sliderWidth-i-t,o=e.m4Y().domain([1,this.numLevels]).range([0,s]).clamp(!0),n=e.Ltv("#slider").append("svg").attr("width",this.sliderWidth).attr("height",50).append("g").attr("transform",`translate(${i}, 30)`);n.append("g").call(e.l78(o).ticks(this.numLevels).tickFormat(e.GPZ("1")));const a=n.append("circle").attr("cx",o(this.activeLevelNumber)).attr("cy",-10).attr("r",10).style("fill","red").style("cursor","ew-resize"),h=e.$Er().on("drag",(t=>{const s=t.x-i,e=Math.round(o.invert(s));a.attr("cx",o(e)),this.updateActiveLevel(e)}));a.call(h)}createJumbotron(){const t=e.Ltv("#jumbotron"),i=e.m4Y().domain([1,this.numLevels]).range(["lightblue","lightcoral"]);for(let s=1;s<=this.numLevels;s++){const e=t.append("div").attr("class","jumbotron-box inactive").on("click",(()=>this.updateActiveLevel(s))).append("svg").attr("width","100%").attr("height","100%");e.append("rect").attr("width","100%").attr("height","100%").attr("fill",i(s)),e.append("text").attr("x","50%").attr("y","50%").attr("dominant-baseline","middle").attr("text-anchor","middle").text(`Level ${s}`)}this.updateActiveLevel(this.activeLevelNumber)}updateActiveLevel(t){this.activeLevelNumber=t,e.Ubm(".jumbotron-box").classed("active",((i,s)=>s+1===t)).classed("inactive",((i,s)=>s+1!==t)),e.Ltv("circle").attr("cx",e.m4Y().domain([1,this.numLevels]).range([0,this.sliderWidth-20])(t)),this.startActiveLevel()}}(8)}},t=>{t.O(0,[96],(()=>{return i=740,t(t.s=i);var i}));t.O()}]);
//# sourceMappingURL=main.dc230a3eaebc9c72e3fb.bundle.js.map